# è¡¥å……æ–‡æ¡£ï¼šå¼€å‘æ•ˆç‡ä¸ç»´æŠ¤ç®¡ç†

> æœ¬æ–‡æ¡£ä½œä¸ºã€Šä¸­å­¦ç”Ÿåœ¨çº¿æ•™è‚²å¹³å°-å®Œæ•´å¼€å‘è·¯å¾„æ–‡æ¡£ã€‹çš„è¡¥å……è¯´æ˜

---

## ğŸ“‹ ç›®å½•

- [1. Claude è¾…åŠ©å¼€å‘æé€Ÿåˆ†æ](#1-claude-è¾…åŠ©å¼€å‘æé€Ÿåˆ†æ)
- [2. æ ¸å¿ƒæ•°æ®è¡¨è¯¦ç»†æ¸…å•](#2-æ ¸å¿ƒæ•°æ®è¡¨è¯¦ç»†æ¸…å•)
- [3. ä»£ç ç»´æŠ¤ä¸å‡çº§ç®¡ç†](#3-ä»£ç ç»´æŠ¤ä¸å‡çº§ç®¡ç†)
- [4. æ•°æ®å¤‡ä»½ä¸ç»´æŠ¤æ–¹æ¡ˆ](#4-æ•°æ®å¤‡ä»½ä¸ç»´æŠ¤æ–¹æ¡ˆ)
- [5. æ ¸å¿ƒ API æ¥å£æ¸…å•](#5-æ ¸å¿ƒ-api-æ¥å£æ¸…å•)

---

## 1. Claude è¾…åŠ©å¼€å‘æé€Ÿåˆ†æ

### 1.1 æ•´ä½“æé€Ÿæ•ˆæœ

**ç»“è®ºï¼šä½¿ç”¨ Claude è¾…åŠ©å¼€å‘ï¼Œå¯ä»¥å°†å¼€å‘å‘¨æœŸä» 4 ä¸ªæœˆç¼©çŸ­åˆ° 1.5-2 ä¸ªæœˆï¼Œæé€Ÿ 2-2.5 å€ï¼**

#### ä¼ ç»Ÿå¼€å‘ vs Claude è¾…åŠ©å¼€å‘å¯¹æ¯”

| å¼€å‘é˜¶æ®µ | ä¼ ç»Ÿå¼€å‘æ—¶é—´ | Claude è¾…åŠ© | èŠ‚çœæ—¶é—´ | æé€Ÿæ¯”ä¾‹ |
|---------|------------|------------|---------|---------|
| éœ€æ±‚åˆ†æä¸æ–‡æ¡£ | 3 å¤© | 1 å¤© | 2 å¤© | âš¡ 3x |
| æ•°æ®åº“è®¾è®¡ | 5 å¤© | 2 å¤© | 3 å¤© | âš¡ 2.5x |
| API è®¾è®¡ | 3 å¤© | 1 å¤© | 2 å¤© | âš¡ 3x |
| åç«¯å¼€å‘ï¼ˆNestJSï¼‰ | 30 å¤© | 12 å¤© | 18 å¤© | âš¡ 2.5x |
| å‰ç«¯å¼€å‘ï¼ˆReactï¼‰ | 25 å¤© | 10 å¤© | 15 å¤© | âš¡ 2.5x |
| æµ‹è¯•ä»£ç ç¼–å†™ | 10 å¤© | 4 å¤© | 6 å¤© | âš¡ 2.5x |
| Bug ä¿®å¤ä¸è°ƒè¯• | 8 å¤© | 5 å¤© | 3 å¤© | âš¡ 1.6x |
| æ–‡æ¡£ç¼–å†™ | 5 å¤© | 1 å¤© | 4 å¤© | âš¡ 5x |
| **æ€»è®¡** | **89 å¤©** | **36 å¤©** | **53 å¤©** | **âš¡ 2.5x** |

---

### 1.2 å…·ä½“åŠŸèƒ½æ¨¡å—æé€Ÿæ¡ˆä¾‹

#### æ¡ˆä¾‹ 1ï¼šç”¨æˆ·æ³¨å†Œç™»å½•æ¨¡å—
```yaml
ä¼ ç»Ÿå¼€å‘æµç¨‹ï¼ˆ3-4 å¤©ï¼‰:
  Day 1: è®¾è®¡æ•°æ®è¡¨ã€ç¼–å†™ Prisma Schema
  Day 2: å®ç°æ³¨å†Œ/ç™»å½• APIã€JWT è®¤è¯
  Day 3: å‰ç«¯ç™»å½•é¡µé¢ã€è¡¨å•éªŒè¯
  Day 4: æµ‹è¯•ã€Bug ä¿®å¤

Claude è¾…åŠ©æµç¨‹ï¼ˆ1-1.5 å¤©ï¼‰:
  30åˆ†é’Ÿ: Claude ç”Ÿæˆå®Œæ•´çš„æ•°æ®è¡¨è®¾è®¡
  1å°æ—¶: Claude ç”Ÿæˆåç«¯ API ä»£ç ï¼ˆController + Serviceï¼‰
  1å°æ—¶: Claude ç”Ÿæˆå‰ç«¯ç™»å½•/æ³¨å†Œé¡µé¢
  2å°æ—¶: äººå·¥å®¡æŸ¥ã€é›†æˆã€è°ƒè¯•
  2å°æ—¶: æµ‹è¯•ç”¨ä¾‹ç¼–å†™

æé€Ÿ: 2.5-3 å€
èŠ‚çœ: 2-2.5 å¤©
```

#### æ¡ˆä¾‹ 2ï¼šè¯¾ç¨‹å­¦ä¹ æ¨¡å—
```yaml
ä¼ ç»Ÿå¼€å‘æµç¨‹ï¼ˆ7-10 å¤©ï¼‰:
  Day 1-2: è®¾è®¡è¯¾ç¨‹æ•°æ®ç»“æ„ï¼ˆå­¦ç§‘ã€ç« èŠ‚ã€è¯¾æ—¶ï¼‰
  Day 3-4: å®ç°è¯¾ç¨‹ç®¡ç† API
  Day 5-6: å®ç°å­¦ä¹ è¿›åº¦è¿½è¸ª
  Day 7-8: å‰ç«¯è¯¾ç¨‹é¡µé¢ã€è§†é¢‘æ’­æ”¾å™¨
  Day 9-10: æµ‹è¯•ã€ä¼˜åŒ–

Claude è¾…åŠ©æµç¨‹ï¼ˆ3-4 å¤©ï¼‰:
  1å°æ—¶: Claude ç”Ÿæˆå®Œæ•´æ•°æ®è¡¨è®¾è®¡
  2å°æ—¶: Claude ç”Ÿæˆè¯¾ç¨‹ CRUD API
  2å°æ—¶: Claude ç”Ÿæˆå­¦ä¹ è¿›åº¦ API
  1å¤©: å‰ç«¯é¡µé¢å¼€å‘ï¼ˆClaude ç”ŸæˆåŸºç¡€ä»£ç ï¼Œäººå·¥ä¼˜åŒ–ï¼‰
  1å¤©: è§†é¢‘æ’­æ”¾å™¨é›†æˆã€æµ‹è¯•

æé€Ÿ: 2-2.5 å€
èŠ‚çœ: 4-6 å¤©
```

#### æ¡ˆä¾‹ 3ï¼šé¢˜åº“ç»ƒä¹ æ¨¡å—
```yaml
ä¼ ç»Ÿå¼€å‘æµç¨‹ï¼ˆ8-12 å¤©ï¼‰:
  Day 1-2: è®¾è®¡é¢˜ç›®æ•°æ®ç»“æ„
  Day 3-4: å®ç°é¢˜ç›®ç®¡ç† API
  Day 5-6: å®ç°ç­”é¢˜æ‰¹æ”¹é€»è¾‘
  Day 7-8: å®ç°ç­”é¢˜ç»Ÿè®¡
  Day 9-10: å‰ç«¯ç­”é¢˜é¡µé¢
  Day 11-12: æµ‹è¯•ã€ä¼˜åŒ–

Claude è¾…åŠ©æµç¨‹ï¼ˆ3-5 å¤©ï¼‰:
  2å°æ—¶: Claude ç”Ÿæˆé¢˜åº“æ•°æ®è¡¨è®¾è®¡
  3å°æ—¶: Claude ç”Ÿæˆé¢˜ç›® CRUD API
  2å°æ—¶: Claude ç”Ÿæˆç­”é¢˜æ‰¹æ”¹ç®—æ³•
  1å¤©: å‰ç«¯ç­”é¢˜é¡µé¢ï¼ˆClaude è¾…åŠ©ï¼‰
  1å¤©: ç­”é¢˜æŠ¥å‘Šé¡µé¢
  1å¤©: æµ‹è¯•ã€ä¼˜åŒ–

æé€Ÿ: 2-2.5 å€
èŠ‚çœ: 5-7 å¤©
```

---

### 1.3 Claude åœ¨ä¸åŒåœºæ™¯çš„ä½œç”¨

#### ğŸ”¥ é«˜æ•ˆåœºæ™¯ï¼ˆæé€Ÿ 3-5 å€ï¼‰

1. **CRUD ä»£ç ç”Ÿæˆ**
   - æ•°æ®æ¨¡å‹ â†’ Claude ç”Ÿæˆ Prisma Schema
   - API æ¥å£ â†’ Claude ç”Ÿæˆ Controller + Service + DTO
   - å‰ç«¯é¡µé¢ â†’ Claude ç”Ÿæˆåˆ—è¡¨/è¡¨å•/è¯¦æƒ…é¡µ

2. **API æ–‡æ¡£ç”Ÿæˆ**
   - Claude è‡ªåŠ¨ç”Ÿæˆ Swagger æ³¨è§£
   - è‡ªåŠ¨ç”Ÿæˆ API ä½¿ç”¨æ–‡æ¡£

3. **æµ‹è¯•ä»£ç ç”Ÿæˆ**
   - Claude ç”Ÿæˆå•å…ƒæµ‹è¯•ç”¨ä¾‹
   - Claude ç”Ÿæˆé›†æˆæµ‹è¯•ç”¨ä¾‹

4. **æ•°æ®åº“è¿ç§»è„šæœ¬**
   - Claude ç”Ÿæˆ Prisma Migration
   - Claude ç”Ÿæˆæ•°æ®åº“ç´¢å¼•ä¼˜åŒ–æ–¹æ¡ˆ

#### âš¡ ä¸­æ•ˆåœºæ™¯ï¼ˆæé€Ÿ 2-3 å€ï¼‰

1. **å¤æ‚ä¸šåŠ¡é€»è¾‘**
   - æ’è¡Œæ¦œç³»ç»Ÿï¼ˆRedis Sorted Setï¼‰
   - å­¦ä¹ è¿›åº¦åŒæ­¥
   - ç­”é¢˜ç»Ÿè®¡åˆ†æ

2. **å‰ç«¯ç»„ä»¶å¼€å‘**
   - å›¾è¡¨ç»„ä»¶ï¼ˆRechartsï¼‰
   - è¡¨å•ç»„ä»¶
   - åˆ—è¡¨ç»„ä»¶

3. **æ€§èƒ½ä¼˜åŒ–**
   - SQL æŸ¥è¯¢ä¼˜åŒ–
   - ç¼“å­˜ç­–ç•¥è®¾è®¡
   - ä»£ç é‡æ„

#### ğŸ’¡ è¾…åŠ©åœºæ™¯ï¼ˆæé€Ÿ 1.5-2 å€ï¼‰

1. **Bug ä¿®å¤**
   - å¿«é€Ÿå®šä½é—®é¢˜
   - æä¾›ä¿®å¤æ–¹æ¡ˆ

2. **æŠ€æœ¯é€‰å‹**
   - å¯¹æ¯”ä¸åŒæ–¹æ¡ˆ
   - æä¾›æœ€ä½³å®è·µ

3. **ä»£ç å®¡æŸ¥**
   - å‘ç°æ½œåœ¨é—®é¢˜
   - æä¾›ä¼˜åŒ–å»ºè®®

---

### 1.4 å®é™…é¡¹ç›®æ—¶é—´è¯„ä¼°

#### æ–¹æ¡ˆ Aï¼šçº¯äººå·¥å¼€å‘ï¼ˆ2 ä¸ªå‰ç«¯ + 2 ä¸ªåç«¯ï¼‰

**MVP é˜¶æ®µï¼ˆWeek 2-8ï¼‰**
- Week 2-3: ç”¨æˆ·ç³»ç»Ÿï¼ˆ2å‘¨ï¼‰
- Week 4-5: è¯¾ç¨‹æ¨¡å—ï¼ˆ2å‘¨ï¼‰
- Week 6-7: é¢˜åº“æ¨¡å—ï¼ˆ2å‘¨ï¼‰
- Week 8: ç»Ÿè®¡æ¨¡å—ï¼ˆ1å‘¨ï¼‰
- **å°è®¡ï¼š7 å‘¨**

**V1.0 é˜¶æ®µï¼ˆWeek 9-16ï¼‰**
- Week 9-10: è®¨è®ºåŒºï¼ˆ2å‘¨ï¼‰
- Week 11-12: æˆé•¿ç³»ç»Ÿï¼ˆ2å‘¨ï¼‰
- Week 13: ç”¨æˆ·ä¸­å¿ƒï¼ˆ1å‘¨ï¼‰
- Week 14-15: æ€§èƒ½ä¼˜åŒ–ï¼ˆ2å‘¨ï¼‰
- Week 16: éƒ¨ç½²ä¸Šçº¿ï¼ˆ1å‘¨ï¼‰
- **å°è®¡ï¼š8 å‘¨**

**æ€»è®¡ï¼š15 å‘¨ï¼ˆçº¦ 3.5 ä¸ªæœˆï¼‰**

---

#### æ–¹æ¡ˆ Bï¼šClaude è¾…åŠ©å¼€å‘ï¼ˆ2 ä¸ªå‰ç«¯ + 2 ä¸ªåç«¯ï¼‰

**MVP é˜¶æ®µï¼ˆWeek 2-5ï¼‰**
- Week 2: ç”¨æˆ·ç³»ç»Ÿï¼ˆ1å‘¨ï¼‰
  - Claude ç”Ÿæˆæ•°æ®è¡¨ã€APIã€å‰ç«¯é¡µé¢
  - äººå·¥é›†æˆã€æµ‹è¯•
- Week 3: è¯¾ç¨‹æ¨¡å—ï¼ˆ1å‘¨ï¼‰
  - Claude ç”Ÿæˆå®Œæ•´æ¨¡å—ä»£ç 
  - äººå·¥è°ƒæ•´ã€é›†æˆè§†é¢‘æ’­æ”¾å™¨
- Week 4: é¢˜åº“æ¨¡å—ï¼ˆ1å‘¨ï¼‰
  - Claude ç”Ÿæˆé¢˜åº“ç³»ç»Ÿ
  - äººå·¥ä¼˜åŒ–ç­”é¢˜é€»è¾‘
- Week 5: ç»Ÿè®¡æ¨¡å—ï¼ˆ1å‘¨ï¼‰
  - Claude ç”Ÿæˆç»Ÿè®¡ API å’Œå›¾è¡¨
  - äººå·¥ä¼˜åŒ–æ•°æ®å±•ç¤º
- **å°è®¡ï¼š4 å‘¨**

**V1.0 é˜¶æ®µï¼ˆWeek 6-9ï¼‰**
- Week 6: è®¨è®ºåŒºï¼ˆ1å‘¨ï¼‰
  - Claude ç”Ÿæˆç¤¾åŒºæ¨¡å—
- Week 7: æˆé•¿ç³»ç»Ÿï¼ˆ1å‘¨ï¼‰
  - Claude ç”Ÿæˆæ’è¡Œæ¦œã€æˆå°±ç³»ç»Ÿ
- Week 8: æ€§èƒ½ä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰
  - Claude æä¾›ä¼˜åŒ–æ–¹æ¡ˆï¼Œäººå·¥å®æ–½
- Week 9: éƒ¨ç½²ä¸Šçº¿ï¼ˆ1å‘¨ï¼‰
  - äººå·¥é…ç½®æœåŠ¡å™¨ã€éƒ¨ç½²
- **å°è®¡ï¼š4 å‘¨**

**æ€»è®¡ï¼š8 å‘¨ï¼ˆçº¦ 2 ä¸ªæœˆï¼‰**

**æé€Ÿï¼šä» 3.5 ä¸ªæœˆç¼©çŸ­åˆ° 2 ä¸ªæœˆï¼ŒèŠ‚çœ 43% æ—¶é—´ï¼**

---

### 1.5 æˆæœ¬èŠ‚çœåˆ†æ

#### äººåŠ›æˆæœ¬å¯¹æ¯”

**ä¼ ç»Ÿå¼€å‘ï¼ˆ3.5 ä¸ªæœˆï¼‰**
```
å‰ç«¯å·¥ç¨‹å¸ˆ Ã— 2: 18,000 Ã— 2 Ã— 3.5 = 126,000 å…ƒ
åç«¯å·¥ç¨‹å¸ˆ Ã— 2: 20,000 Ã— 2 Ã— 3.5 = 140,000 å…ƒ
æ€»è®¡: 266,000 å…ƒ
```

**Claude è¾…åŠ©å¼€å‘ï¼ˆ2 ä¸ªæœˆï¼‰**
```
å‰ç«¯å·¥ç¨‹å¸ˆ Ã— 2: 18,000 Ã— 2 Ã— 2 = 72,000 å…ƒ
åç«¯å·¥ç¨‹å¸ˆ Ã— 2: 20,000 Ã— 2 Ã— 2 = 80,000 å…ƒ
Claude API æˆæœ¬: çº¦ 1,000 å…ƒ/æœˆ Ã— 2 = 2,000 å…ƒ
æ€»è®¡: 154,000 å…ƒ
```

**èŠ‚çœæˆæœ¬ï¼š112,000 å…ƒï¼ˆ42%ï¼‰**

---

## 2. æ ¸å¿ƒæ•°æ®è¡¨è¯¦ç»†æ¸…å•

### 2.1 MVP é˜¶æ®µæ ¸å¿ƒæ•°æ®è¡¨ï¼ˆ18 å¼ ï¼‰

#### ç”¨æˆ·æ¨¡å—ï¼ˆ3 å¼ è¡¨ï¼‰

**1. users - ç”¨æˆ·åŸºæœ¬ä¿¡æ¯**
```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  username VARCHAR(50) UNIQUE NOT NULL,
  email VARCHAR(100) UNIQUE,
  phone VARCHAR(20) UNIQUE,
  password_hash VARCHAR(255) NOT NULL,
  role VARCHAR(20) DEFAULT 'student', -- student, teacher, admin
  status VARCHAR(20) DEFAULT 'active', -- active, inactive, banned
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_phone ON users(phone);
CREATE INDEX idx_users_role ON users(role);
```

**2. user_profiles - ç”¨æˆ·è¯¦ç»†èµ„æ–™**
```sql
CREATE TABLE user_profiles (
  id SERIAL PRIMARY KEY,
  user_id INTEGER UNIQUE REFERENCES users(id) ON DELETE CASCADE,
  real_name VARCHAR(50),
  avatar_url VARCHAR(255),
  grade INTEGER, -- 7, 8, 9
  class_name VARCHAR(50),
  school VARCHAR(100),
  location VARCHAR(100),
  bio TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_profiles_user ON user_profiles(user_id);
CREATE INDEX idx_profiles_grade ON user_profiles(grade);
```

**3. user_settings - ç”¨æˆ·è®¾ç½®**
```sql
CREATE TABLE user_settings (
  id SERIAL PRIMARY KEY,
  user_id INTEGER UNIQUE REFERENCES users(id) ON DELETE CASCADE,
  daily_goal_minutes INTEGER DEFAULT 60,
  default_difficulty VARCHAR(20) DEFAULT 'medium',
  email_notification BOOLEAN DEFAULT true,
  push_notification BOOLEAN DEFAULT true,
  theme VARCHAR(20) DEFAULT 'light', -- light, dark
  language VARCHAR(10) DEFAULT 'zh', -- zh, en
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

---

#### è¯¾ç¨‹å­¦ä¹ æ¨¡å—ï¼ˆ5 å¼ è¡¨ï¼‰

**4. subjects - å­¦ç§‘**
```sql
CREATE TABLE subjects (
  id SERIAL PRIMARY KEY,
  name VARCHAR(50) NOT NULL,
  name_en VARCHAR(50),
  icon VARCHAR(10), -- emoji
  color VARCHAR(20),
  description TEXT,
  sort_order INTEGER,
  status VARCHAR(20) DEFAULT 'active',
  created_at TIMESTAMP DEFAULT NOW()
);

-- åˆå§‹æ•°æ®
INSERT INTO subjects (name, name_en, icon, color, sort_order) VALUES
  ('æ•°å­¦', 'Math', 'ğŸ“', 'bg-blue-500', 1),
  ('è¯­æ–‡', 'Chinese', 'ğŸ“š', 'bg-green-500', 2),
  ('è‹±è¯­', 'English', 'ğŸ”¤', 'bg-purple-500', 3),
  ('ç‰©ç†', 'Physics', 'âš›ï¸', 'bg-orange-500', 4),
  ('åŒ–å­¦', 'Chemistry', 'ğŸ§ª', 'bg-pink-500', 5),
  ('ç”Ÿç‰©', 'Biology', 'ğŸ§¬', 'bg-teal-500', 6);
```

**5. chapters - ç« èŠ‚**
```sql
CREATE TABLE chapters (
  id SERIAL PRIMARY KEY,
  subject_id INTEGER REFERENCES subjects(id) ON DELETE CASCADE,
  title VARCHAR(100) NOT NULL,
  title_en VARCHAR(100),
  description TEXT,
  sort_order INTEGER,
  status VARCHAR(20) DEFAULT 'active',
  created_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_chapters_subject ON chapters(subject_id);
```

**6. lessons - è¯¾æ—¶**
```sql
CREATE TABLE lessons (
  id SERIAL PRIMARY KEY,
  chapter_id INTEGER REFERENCES chapters(id) ON DELETE CASCADE,
  title VARCHAR(100) NOT NULL,
  title_en VARCHAR(100),
  type VARCHAR(20), -- video, document, exercise, test
  content_url VARCHAR(255), -- OSS URL
  video_duration INTEGER, -- è§†é¢‘æ—¶é•¿ï¼ˆç§’ï¼‰
  sort_order INTEGER,
  is_free BOOLEAN DEFAULT false,
  prerequisite_lesson_id INTEGER REFERENCES lessons(id), -- å‰ç½®è¯¾ç¨‹
  status VARCHAR(20) DEFAULT 'active',
  created_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_lessons_chapter ON lessons(chapter_id);
CREATE INDEX idx_lessons_type ON lessons(type);
```

**7. course_materials - è¯¾ä»¶èµ„æº**
```sql
CREATE TABLE course_materials (
  id SERIAL PRIMARY KEY,
  lesson_id INTEGER REFERENCES lessons(id) ON DELETE CASCADE,
  type VARCHAR(20), -- pdf, ppt, doc, image
  title VARCHAR(100),
  file_url VARCHAR(255),
  file_size INTEGER, -- bytes
  sort_order INTEGER,
  created_at TIMESTAMP DEFAULT NOW()
);
```

**8. user_learning_progress - å­¦ä¹ è¿›åº¦**
```sql
CREATE TABLE user_learning_progress (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  lesson_id INTEGER REFERENCES lessons(id) ON DELETE CASCADE,
  progress INTEGER DEFAULT 0, -- è¿›åº¦ç™¾åˆ†æ¯” 0-100
  duration INTEGER DEFAULT 0, -- å·²å­¦ä¹ æ—¶é•¿ï¼ˆç§’ï¼‰
  completed BOOLEAN DEFAULT false,
  last_position INTEGER DEFAULT 0, -- è§†é¢‘æ’­æ”¾ä½ç½®ï¼ˆç§’ï¼‰
  completed_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, lesson_id)
);

-- ç´¢å¼•
CREATE INDEX idx_progress_user ON user_learning_progress(user_id);
CREATE INDEX idx_progress_lesson ON user_learning_progress(lesson_id);
CREATE INDEX idx_progress_completed ON user_learning_progress(completed);
```

---

#### é¢˜åº“æ¨¡å—ï¼ˆ5 å¼ è¡¨ï¼‰

**9. questions - é¢˜ç›®**
```sql
CREATE TABLE questions (
  id SERIAL PRIMARY KEY,
  subject_id INTEGER REFERENCES subjects(id),
  chapter_id INTEGER REFERENCES chapters(id),
  type VARCHAR(20), -- single_choice, multiple_choice, true_false, fill_blank, essay
  difficulty VARCHAR(20), -- easy, medium, hard
  content TEXT NOT NULL,
  answer TEXT, -- æ ‡å‡†ç­”æ¡ˆï¼ˆJSON æ ¼å¼ï¼‰
  explanation TEXT, -- è§£æ
  points INTEGER DEFAULT 1, -- åˆ†å€¼
  view_count INTEGER DEFAULT 0,
  correct_count INTEGER DEFAULT 0,
  total_count INTEGER DEFAULT 0,
  status VARCHAR(20) DEFAULT 'active',
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_questions_subject ON questions(subject_id);
CREATE INDEX idx_questions_chapter ON questions(chapter_id);
CREATE INDEX idx_questions_difficulty ON questions(difficulty);
CREATE INDEX idx_questions_type ON questions(type);
```

**10. question_options - é€‰é¡¹ï¼ˆç”¨äºé€‰æ‹©é¢˜ï¼‰**
```sql
CREATE TABLE question_options (
  id SERIAL PRIMARY KEY,
  question_id INTEGER REFERENCES questions(id) ON DELETE CASCADE,
  option_key VARCHAR(10), -- A, B, C, D, E
  option_content TEXT NOT NULL,
  is_correct BOOLEAN DEFAULT false,
  sort_order INTEGER
);

-- ç´¢å¼•
CREATE INDEX idx_options_question ON question_options(question_id);
```

**11. question_sets - ç»ƒä¹ é›†**
```sql
CREATE TABLE question_sets (
  id SERIAL PRIMARY KEY,
  subject_id INTEGER REFERENCES subjects(id),
  title VARCHAR(100) NOT NULL,
  description TEXT,
  difficulty VARCHAR(20),
  question_count INTEGER,
  time_limit INTEGER, -- æ—¶é•¿é™åˆ¶ï¼ˆåˆ†é’Ÿï¼‰
  total_points INTEGER,
  status VARCHAR(20) DEFAULT 'active',
  created_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_sets_subject ON question_sets(subject_id);
```

**12. user_answers - ç­”é¢˜è®°å½•**
```sql
CREATE TABLE user_answers (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  question_id INTEGER REFERENCES questions(id),
  question_set_id INTEGER REFERENCES question_sets(id),
  user_answer TEXT, -- JSON æ ¼å¼
  is_correct BOOLEAN,
  score INTEGER,
  time_spent INTEGER, -- ç­”é¢˜ç”¨æ—¶ï¼ˆç§’ï¼‰
  created_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•ï¼ˆé‡è¦ï¼ç­”é¢˜è®°å½•é‡å¤§ï¼‰
CREATE INDEX idx_answers_user ON user_answers(user_id);
CREATE INDEX idx_answers_question ON user_answers(question_id);
CREATE INDEX idx_answers_set ON user_answers(question_set_id);
CREATE INDEX idx_answers_created ON user_answers(created_at);

-- åˆ†åŒºç­–ç•¥ï¼ˆå¤§è§„æ¨¡æ—¶ï¼‰
-- æŒ‰æœˆåˆ†åŒº
CREATE TABLE user_answers_202501 PARTITION OF user_answers
  FOR VALUES FROM ('2025-01-01') TO ('2025-02-01');
```

**13. wrong_questions - é”™é¢˜æœ¬**
```sql
CREATE TABLE wrong_questions (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  question_id INTEGER REFERENCES questions(id) ON DELETE CASCADE,
  wrong_count INTEGER DEFAULT 1,
  mastered BOOLEAN DEFAULT false,
  last_wrong_at TIMESTAMP DEFAULT NOW(),
  mastered_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, question_id)
);

-- ç´¢å¼•
CREATE INDEX idx_wrong_user ON wrong_questions(user_id);
CREATE INDEX idx_wrong_mastered ON wrong_questions(mastered);
```

---

#### ç»Ÿè®¡åˆ†ææ¨¡å—ï¼ˆ3 å¼ è¡¨ï¼‰

**14. daily_stats - æ¯æ—¥ç»Ÿè®¡**
```sql
CREATE TABLE daily_stats (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  date DATE NOT NULL,
  study_duration INTEGER DEFAULT 0, -- å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
  questions_completed INTEGER DEFAULT 0,
  questions_correct INTEGER DEFAULT 0,
  lessons_completed INTEGER DEFAULT 0,
  points_earned INTEGER DEFAULT 0,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, date)
);

-- ç´¢å¼•
CREATE INDEX idx_daily_user_date ON daily_stats(user_id, date);
CREATE INDEX idx_daily_date ON daily_stats(date);
```

**15. subject_stats - å­¦ç§‘ç»Ÿè®¡**
```sql
CREATE TABLE subject_stats (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  subject_id INTEGER REFERENCES subjects(id) ON DELETE CASCADE,
  total_lessons INTEGER DEFAULT 0,
  completed_lessons INTEGER DEFAULT 0,
  total_questions INTEGER DEFAULT 0,
  correct_questions INTEGER DEFAULT 0,
  avg_score DECIMAL(5,2) DEFAULT 0,
  study_duration INTEGER DEFAULT 0, -- å­¦ä¹ æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
  last_study_at TIMESTAMP,
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, subject_id)
);

-- ç´¢å¼•
CREATE INDEX idx_subject_stats_user ON subject_stats(user_id);
```

**16. chapter_mastery - ç« èŠ‚æŒæ¡åº¦**
```sql
CREATE TABLE chapter_mastery (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  chapter_id INTEGER REFERENCES chapters(id) ON DELETE CASCADE,
  mastery_level INTEGER DEFAULT 0, -- æŒæ¡åº¦ 0-100
  practice_count INTEGER DEFAULT 0,
  correct_rate DECIMAL(5,2) DEFAULT 0,
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, chapter_id)
);

-- ç´¢å¼•
CREATE INDEX idx_mastery_user ON chapter_mastery(user_id);
```

---

#### æˆé•¿ç³»ç»Ÿæ¨¡å—ï¼ˆ2 å¼ è¡¨ - MVP ç®€åŒ–ç‰ˆï¼‰

**17. user_levels - ç”¨æˆ·ç­‰çº§**
```sql
CREATE TABLE user_levels (
  id SERIAL PRIMARY KEY,
  user_id INTEGER UNIQUE REFERENCES users(id) ON DELETE CASCADE,
  level INTEGER DEFAULT 1,
  experience INTEGER DEFAULT 0,
  next_level_exp INTEGER DEFAULT 100,
  streak_days INTEGER DEFAULT 0, -- è¿ç»­å­¦ä¹ å¤©æ•°
  last_checkin_date DATE,
  updated_at TIMESTAMP DEFAULT NOW()
);
```

**18. user_checkins - å­¦ä¹ æ‰“å¡**
```sql
CREATE TABLE user_checkins (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  checkin_date DATE NOT NULL,
  study_duration INTEGER DEFAULT 0,
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, checkin_date)
);

-- ç´¢å¼•
CREATE INDEX idx_checkins_user_date ON user_checkins(user_id, checkin_date);
```

---

### 2.2 V1.0 å®Œæ•´ç‰ˆæ•°æ®è¡¨ï¼ˆæ–°å¢ 12 å¼ ï¼Œå…± 30 å¼ ï¼‰

#### è®¨è®ºç¤¾åŒºæ¨¡å—ï¼ˆ5 å¼ è¡¨ï¼‰

**19. posts - å¸–å­**
```sql
CREATE TABLE posts (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  subject_id INTEGER REFERENCES subjects(id),
  title VARCHAR(200) NOT NULL,
  content TEXT NOT NULL,
  view_count INTEGER DEFAULT 0,
  like_count INTEGER DEFAULT 0,
  comment_count INTEGER DEFAULT 0,
  favorite_count INTEGER DEFAULT 0,
  is_hot BOOLEAN DEFAULT false,
  is_pinned BOOLEAN DEFAULT false,
  status VARCHAR(20) DEFAULT 'published', -- draft, published, deleted, reviewed
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_posts_user ON posts(user_id);
CREATE INDEX idx_posts_subject ON posts(subject_id);
CREATE INDEX idx_posts_hot ON posts(is_hot);
CREATE INDEX idx_posts_created ON posts(created_at DESC);
CREATE INDEX idx_posts_status ON posts(status);

-- å…¨æ–‡æœç´¢ç´¢å¼•ï¼ˆPostgreSQLï¼‰
CREATE INDEX idx_posts_search ON posts USING gin(to_tsvector('chinese', title || ' ' || content));
```

**20. comments - è¯„è®º**
```sql
CREATE TABLE comments (
  id SERIAL PRIMARY KEY,
  post_id INTEGER REFERENCES posts(id) ON DELETE CASCADE,
  user_id INTEGER REFERENCES users(id),
  parent_id INTEGER REFERENCES comments(id), -- å›å¤çš„è¯„è®ºID
  content TEXT NOT NULL,
  like_count INTEGER DEFAULT 0,
  status VARCHAR(20) DEFAULT 'published',
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_comments_post ON comments(post_id);
CREATE INDEX idx_comments_user ON comments(user_id);
CREATE INDEX idx_comments_parent ON comments(parent_id);
```

**21. post_likes - ç‚¹èµ**
```sql
CREATE TABLE post_likes (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  post_id INTEGER REFERENCES posts(id) ON DELETE CASCADE,
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, post_id)
);

-- ç´¢å¼•
CREATE INDEX idx_likes_user ON post_likes(user_id);
CREATE INDEX idx_likes_post ON post_likes(post_id);
```

**22. post_favorites - æ”¶è—**
```sql
CREATE TABLE post_favorites (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  post_id INTEGER REFERENCES posts(id) ON DELETE CASCADE,
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, post_id)
);
```

**23. post_tags - å¸–å­æ ‡ç­¾ï¼ˆå¯é€‰ï¼‰**
```sql
CREATE TABLE post_tags (
  id SERIAL PRIMARY KEY,
  post_id INTEGER REFERENCES posts(id) ON DELETE CASCADE,
  tag VARCHAR(50) NOT NULL,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_tags_post ON post_tags(post_id);
CREATE INDEX idx_tags_tag ON post_tags(tag);
```

---

#### æˆé•¿ç³»ç»Ÿå®Œæ•´ç‰ˆï¼ˆæ–°å¢ 3 å¼ è¡¨ï¼‰

**24. achievements - æˆå°±å®šä¹‰**
```sql
CREATE TABLE achievements (
  id SERIAL PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  name_en VARCHAR(100),
  description TEXT,
  icon VARCHAR(50), -- emoji
  type VARCHAR(50), -- beginner, diligent, master, perfect_score, etc.
  condition_type VARCHAR(50), -- lessons_completed, questions_correct, streak_days
  condition_value INTEGER,
  reward_exp INTEGER DEFAULT 0,
  sort_order INTEGER,
  created_at TIMESTAMP DEFAULT NOW()
);

-- åˆå§‹æ•°æ®
INSERT INTO achievements (name, name_en, icon, type, condition_type, condition_value, reward_exp) VALUES
  ('åˆå­¦è€…', 'Beginner', 'ğŸ¯', 'beginner', 'lessons_completed', 10, 100),
  ('å‹¤å¥‹å¥½å­¦', 'Diligent', 'â­', 'diligent', 'streak_days', 7, 200),
  ('å­¦ä¹ è¾¾äºº', 'Master', 'ğŸ’ª', 'master', 'lessons_completed', 100, 500),
  ('æ»¡åˆ†ç‹è€…', 'Perfect Score', 'ğŸ’¯', 'perfect_score', 'perfect_scores', 10, 1000);
```

**25. user_achievements - ç”¨æˆ·æˆå°±è®°å½•**
```sql
CREATE TABLE user_achievements (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  achievement_id INTEGER REFERENCES achievements(id) ON DELETE CASCADE,
  progress INTEGER DEFAULT 0,
  unlocked BOOLEAN DEFAULT false,
  unlocked_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, achievement_id)
);

-- ç´¢å¼•
CREATE INDEX idx_user_achievements_user ON user_achievements(user_id);
CREATE INDEX idx_user_achievements_unlocked ON user_achievements(unlocked);
```

**26. rankings - æ’è¡Œæ¦œï¼ˆå¿«ç…§ï¼‰**
```sql
CREATE TABLE rankings (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  rank_type VARCHAR(50), -- school, class, grade, subject
  rank_value INTEGER, -- æ’å
  score INTEGER, -- ç§¯åˆ†
  period VARCHAR(50), -- week, month, all_time
  period_start DATE,
  period_end DATE,
  snapshot_date DATE,
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, rank_type, period, snapshot_date)
);

-- ç´¢å¼•
CREATE INDEX idx_rankings_type_period ON rankings(rank_type, period);
CREATE INDEX idx_rankings_snapshot ON rankings(snapshot_date);
```

---

#### é€šçŸ¥ç³»ç»Ÿï¼ˆ2 å¼ è¡¨ï¼‰

**27. notifications - é€šçŸ¥æ¶ˆæ¯**
```sql
CREATE TABLE notifications (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  type VARCHAR(50), -- comment, like, achievement, system
  title VARCHAR(200) NOT NULL,
  content TEXT,
  link VARCHAR(255), -- è·³è½¬é“¾æ¥
  is_read BOOLEAN DEFAULT false,
  created_at TIMESTAMP DEFAULT NOW(),
  read_at TIMESTAMP
);

-- ç´¢å¼•
CREATE INDEX idx_notifications_user ON notifications(user_id);
CREATE INDEX idx_notifications_read ON notifications(is_read);
CREATE INDEX idx_notifications_created ON notifications(created_at DESC);
```

**28. notification_settings - é€šçŸ¥è®¾ç½®**
```sql
CREATE TABLE notification_settings (
  id SERIAL PRIMARY KEY,
  user_id INTEGER UNIQUE REFERENCES users(id) ON DELETE CASCADE,
  email_notification BOOLEAN DEFAULT true,
  push_notification BOOLEAN DEFAULT true,
  comment_notification BOOLEAN DEFAULT true,
  like_notification BOOLEAN DEFAULT true,
  achievement_notification BOOLEAN DEFAULT true,
  system_notification BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

---

#### ç³»ç»Ÿç®¡ç†ï¼ˆ2 å¼ è¡¨ï¼‰

**29. admin_logs - ç®¡ç†å‘˜æ“ä½œæ—¥å¿—**
```sql
CREATE TABLE admin_logs (
  id SERIAL PRIMARY KEY,
  admin_id INTEGER REFERENCES users(id),
  action VARCHAR(50), -- create, update, delete, ban_user
  target_type VARCHAR(50), -- user, post, question
  target_id INTEGER,
  details JSONB,
  ip_address VARCHAR(50),
  user_agent TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

-- ç´¢å¼•
CREATE INDEX idx_admin_logs_admin ON admin_logs(admin_id);
CREATE INDEX idx_admin_logs_action ON admin_logs(action);
CREATE INDEX idx_admin_logs_created ON admin_logs(created_at DESC);
```

**30. system_configs - ç³»ç»Ÿé…ç½®**
```sql
CREATE TABLE system_configs (
  id SERIAL PRIMARY KEY,
  key VARCHAR(100) UNIQUE NOT NULL,
  value TEXT,
  description TEXT,
  type VARCHAR(20), -- string, number, boolean, json
  updated_at TIMESTAMP DEFAULT NOW()
);

-- åˆå§‹æ•°æ®
INSERT INTO system_configs (key, value, description, type) VALUES
  ('site_name', 'ä¸­å­¦ç”Ÿåœ¨çº¿æ•™è‚²å¹³å°', 'ç½‘ç«™åç§°', 'string'),
  ('max_upload_size', '10485760', 'æœ€å¤§ä¸Šä¼ æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰', 'number'),
  ('enable_registration', 'true', 'æ˜¯å¦å¼€æ”¾æ³¨å†Œ', 'boolean');
```

---

### 2.3 æ•°æ®è¡¨æ€»ç»“

```yaml
MVP é˜¶æ®µï¼ˆåŸºç¡€æ ¸å¿ƒåŠŸèƒ½ï¼‰: 18 å¼ è¡¨
  ç”¨æˆ·æ¨¡å—: 3 å¼ 
  è¯¾ç¨‹æ¨¡å—: 5 å¼ 
  é¢˜åº“æ¨¡å—: 5 å¼ 
  ç»Ÿè®¡æ¨¡å—: 3 å¼ 
  æˆé•¿ç³»ç»Ÿï¼ˆç®€åŒ–ï¼‰: 2 å¼ 

V1.0 é˜¶æ®µï¼ˆå®Œæ•´åŠŸèƒ½ï¼‰: 30 å¼ è¡¨
  MVP åŸºç¡€: 18 å¼ 
  è®¨è®ºç¤¾åŒº: 5 å¼ 
  æˆé•¿ç³»ç»Ÿï¼ˆå®Œæ•´ï¼‰: 3 å¼ 
  é€šçŸ¥ç³»ç»Ÿ: 2 å¼ 
  ç³»ç»Ÿç®¡ç†: 2 å¼ 

V2.0+ æ‰©å±•åŠŸèƒ½: 40+ å¼ è¡¨
  ç›´æ’­ç³»ç»Ÿ: 3-5 å¼ 
  å®¶é•¿ç«¯: 2-3 å¼ 
  æ¶ˆæ¯ç³»ç»Ÿ: 2-3 å¼ 
  å†…å®¹ç®¡ç†: 3-5 å¼ 
```

---

## 3. ä»£ç ç»´æŠ¤ä¸å‡çº§ç®¡ç†

### 3.1 ç‰ˆæœ¬ç®¡ç†ç­–ç•¥

#### Git åˆ†æ”¯ç®¡ç†ï¼ˆGit Flowï¼‰

```
main (ç”Ÿäº§ç¯å¢ƒ)
  â””â”€ production-v1.0.0
  â””â”€ production-v1.1.0

develop (å¼€å‘ç¯å¢ƒ)
  â””â”€ feature/user-auth
  â””â”€ feature/course-learning
  â””â”€ feature/question-bank

staging (é¢„å‘å¸ƒç¯å¢ƒ)
  â””â”€ release/v1.0.0

hotfix (ç´§æ€¥ä¿®å¤)
  â””â”€ hotfix/login-bug
```

**åˆ†æ”¯è§„èŒƒ**ï¼š
```yaml
ä¸»åˆ†æ”¯:
  - main: ç”Ÿäº§ç¯å¢ƒï¼Œåªèƒ½é€šè¿‡ PR åˆå¹¶ï¼Œéœ€è¦ code review
  - develop: å¼€å‘ç¯å¢ƒï¼Œé›†æˆæ‰€æœ‰å¼€å‘ä¸­çš„åŠŸèƒ½

è¾…åŠ©åˆ†æ”¯:
  - feature/*: æ–°åŠŸèƒ½å¼€å‘
    å‘½å: feature/åŠŸèƒ½åç§°
    ç¤ºä¾‹: feature/user-auth, feature/course-learning

  - release/*: é¢„å‘å¸ƒç‰ˆæœ¬
    å‘½å: release/vç‰ˆæœ¬å·
    ç¤ºä¾‹: release/v1.0.0

  - hotfix/*: ç´§æ€¥ä¿®å¤
    å‘½å: hotfix/bugæè¿°
    ç¤ºä¾‹: hotfix/login-bug

  - bugfix/*: æ™®é€š bug ä¿®å¤
    å‘½å: bugfix/bugæè¿°
```

**å·¥ä½œæµç¨‹**ï¼š
```bash
# 1. æ–°åŠŸèƒ½å¼€å‘
git checkout -b feature/user-auth develop
# å¼€å‘å®Œæˆåï¼Œæäº¤ PR åˆ° develop

# 2. å‘å¸ƒæ–°ç‰ˆæœ¬
git checkout -b release/v1.0.0 develop
# æµ‹è¯•é€šè¿‡åï¼Œåˆå¹¶åˆ° main å’Œ develop

# 3. ç´§æ€¥ä¿®å¤
git checkout -b hotfix/login-bug main
# ä¿®å¤å®Œæˆåï¼Œåˆå¹¶åˆ° main å’Œ develop
```

---

### 3.2 è¯­ä¹‰åŒ–ç‰ˆæœ¬å·ï¼ˆSemantic Versioningï¼‰

**æ ¼å¼ï¼šä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å· (MAJOR.MINOR.PATCH)**

```yaml
ç‰ˆæœ¬å·è§„åˆ™:
  ä¸»ç‰ˆæœ¬å· (MAJOR): ä¸å…¼å®¹çš„ API ä¿®æ”¹
    ç¤ºä¾‹: 1.0.0 â†’ 2.0.0

  æ¬¡ç‰ˆæœ¬å· (MINOR): å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢
    ç¤ºä¾‹: 1.0.0 â†’ 1.1.0

  ä¿®è®¢å· (PATCH): å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£
    ç¤ºä¾‹: 1.0.0 â†’ 1.0.1

ç‰ˆæœ¬ç¤ºä¾‹:
  v0.1.0 - MVP å†…æµ‹ç‰ˆæœ¬
  v1.0.0 - æ­£å¼ä¸Šçº¿ç‰ˆæœ¬
  v1.1.0 - æ–°å¢è®¨è®ºåŒºåŠŸèƒ½
  v1.1.1 - ä¿®å¤ç™»å½• bug
  v1.2.0 - æ–°å¢æˆé•¿ç³»ç»Ÿ
  v2.0.0 - æ¶æ„é‡æ„ï¼Œå¾®æœåŠ¡åŒ–
```

---

### 3.3 ä»£ç å®¡æŸ¥ï¼ˆCode Reviewï¼‰æœºåˆ¶

#### PRï¼ˆPull Requestï¼‰æµç¨‹

```yaml
1. å¼€å‘è€…æäº¤ PR:
   - å¡«å†™ PR æè¿°ï¼ˆåŠŸèƒ½è¯´æ˜ã€æµ‹è¯•æƒ…å†µï¼‰
   - å…³è” Issue
   - è‡ªæ£€æ¸…å•ï¼ˆä»£ç è§„èŒƒã€æµ‹è¯•é€šè¿‡ï¼‰

2. è‡ªåŠ¨åŒ–æ£€æŸ¥:
   - ESLint æ£€æŸ¥é€šè¿‡
   - å•å…ƒæµ‹è¯•é€šè¿‡
   - ä»£ç è¦†ç›–ç‡ >80%
   - æ— å®‰å…¨æ¼æ´

3. Code Review:
   - è‡³å°‘ 1 äººå®¡æŸ¥
   - æ£€æŸ¥é¡¹ï¼šä»£ç è´¨é‡ã€å®‰å…¨æ€§ã€æ€§èƒ½
   - æå‡ºä¿®æ”¹æ„è§

4. ä¿®æ”¹ä¸åˆå¹¶:
   - å¼€å‘è€…æ ¹æ®æ„è§ä¿®æ”¹
   - å®¡æŸ¥é€šè¿‡ååˆå¹¶
```

**Code Review æ£€æŸ¥æ¸…å•**ï¼š
```markdown
## Code Review Checklist

### ä»£ç è´¨é‡
- [ ] ä»£ç ç¬¦åˆé¡¹ç›®è§„èŒƒï¼ˆESLint è§„åˆ™ï¼‰
- [ ] å˜é‡å‘½åæ¸…æ™°æ˜“æ‡‚
- [ ] å‡½æ•°åŠŸèƒ½å•ä¸€ï¼Œä¸è¶…è¿‡ 50 è¡Œ
- [ ] é¿å…é‡å¤ä»£ç ï¼ˆDRY åŸåˆ™ï¼‰
- [ ] æœ‰å¿…è¦çš„æ³¨é‡Šï¼ˆå¤æ‚é€»è¾‘ï¼‰

### åŠŸèƒ½å®ç°
- [ ] åŠŸèƒ½å®ç°ç¬¦åˆéœ€æ±‚
- [ ] è¾¹ç•Œæƒ…å†µå¤„ç†å®Œæ•´
- [ ] é”™è¯¯å¤„ç†å¾—å½“

### å®‰å…¨æ€§
- [ ] æ—  SQL æ³¨å…¥é£é™©
- [ ] æ—  XSS æ”»å‡»é£é™©
- [ ] æ•æ„Ÿä¿¡æ¯å·²åŠ å¯†
- [ ] è¾“å…¥éªŒè¯å®Œæ•´

### æ€§èƒ½
- [ ] æ— æ˜æ˜¾æ€§èƒ½é—®é¢˜
- [ ] æ•°æ®åº“æŸ¥è¯¢å·²ä¼˜åŒ–
- [ ] æ—  N+1 æŸ¥è¯¢
- [ ] åˆç†ä½¿ç”¨ç¼“å­˜

### æµ‹è¯•
- [ ] å•å…ƒæµ‹è¯•å®Œæ•´
- [ ] æµ‹è¯•ç”¨ä¾‹è¦†ç›–ä¸»è¦åœºæ™¯
- [ ] æµ‹è¯•é€šè¿‡
```

---

### 3.4 CI/CD è‡ªåŠ¨åŒ–æµç¨‹

#### GitHub Actions é…ç½®ç¤ºä¾‹

```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  # å‰ç«¯æµ‹è¯•
  frontend-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Install dependencies
        run: cd frontend && npm ci

      - name: Lint
        run: cd frontend && npm run lint

      - name: Type check
        run: cd frontend && npm run type-check

      - name: Unit tests
        run: cd frontend && npm run test

      - name: Build
        run: cd frontend && npm run build

  # åç«¯æµ‹è¯•
  backend-test:
    runs-on: ubuntu-latest
    services:
      postgres:
        image: postgres:14
        env:
          POSTGRES_PASSWORD: postgres
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5

    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Install dependencies
        run: cd backend && npm ci

      - name: Lint
        run: cd backend && npm run lint

      - name: Unit tests
        run: cd backend && npm run test

      - name: E2E tests
        run: cd backend && npm run test:e2e

      - name: Build
        run: cd backend && npm run build

  # éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼ˆä»… main åˆ†æ”¯ï¼‰
  deploy-production:
    needs: [frontend-test, backend-test]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v3

      - name: Deploy to Vercel (Frontend)
        run: |
          cd frontend
          npm install -g vercel
          vercel --prod --token=${{ secrets.VERCEL_TOKEN }}

      - name: Deploy to AWS (Backend)
        run: |
          # éƒ¨ç½²åç«¯åˆ° AWS/é˜¿é‡Œäº‘
          # ä½¿ç”¨ Docker + SSH
```

---

### 3.5 æ•°æ®åº“è¿ç§»ç®¡ç†ï¼ˆPrisma Migrationsï¼‰

#### è¿ç§»æµç¨‹

```bash
# 1. ä¿®æ”¹ schema.prisma
vim prisma/schema.prisma

# 2. ç”Ÿæˆè¿ç§»æ–‡ä»¶
npx prisma migrate dev --name add_user_settings_table

# 3. æŸ¥çœ‹ç”Ÿæˆçš„ SQL
cat prisma/migrations/20250108_add_user_settings_table/migration.sql

# 4. åº”ç”¨åˆ°æµ‹è¯•ç¯å¢ƒ
npx prisma migrate deploy

# 5. åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒï¼ˆè°¨æ…ï¼ï¼‰
NODE_ENV=production npx prisma migrate deploy
```

**è¿ç§»æœ€ä½³å®è·µ**ï¼š
```yaml
å¼€å‘ç¯å¢ƒ:
  - ä½¿ç”¨ prisma migrate dev
  - è‡ªåŠ¨ç”Ÿæˆè¿ç§»æ–‡ä»¶
  - è‡ªåŠ¨é‡æ–°ç”Ÿæˆ Prisma Client

ç”Ÿäº§ç¯å¢ƒ:
  - ä½¿ç”¨ prisma migrate deploy
  - åœ¨ç»´æŠ¤çª—å£æ‰§è¡Œ
  - æå‰å¤‡ä»½æ•°æ®åº“
  - ç°åº¦å‘å¸ƒï¼ˆå…ˆéƒ¨ç½²ä»åº“ï¼Œå†åˆ‡æ¢ä¸»åº“ï¼‰

å›æ»šç­–ç•¥:
  - ä¿ç•™æ‰€æœ‰è¿ç§»æ–‡ä»¶
  - ç¼–å†™å›æ»š SQLï¼ˆmigrations/rollback/ï¼‰
  - æµ‹è¯•å›æ»šæµç¨‹
```

---

### 3.6 ä¾èµ–ç®¡ç†ä¸å®‰å…¨æ›´æ–°

#### package.json ç‰ˆæœ¬é”å®š

```json
{
  "dependencies": {
    "react": "^18.2.0",        // å…è®¸å°ç‰ˆæœ¬æ›´æ–°
    "react-dom": "18.2.0",     // é”å®šç‰ˆæœ¬
    "@nestjs/core": "~10.0.0"  // åªå…è®¸è¡¥ä¸æ›´æ–°
  }
}
```

**ç‰ˆæœ¬ç¬¦å·è¯´æ˜**ï¼š
```yaml
^1.2.3: å…è®¸ 1.x.x çš„æ›´æ–°ï¼ˆä¸æ”¹å˜ä¸»ç‰ˆæœ¬å·ï¼‰
~1.2.3: åªå…è®¸ 1.2.x çš„æ›´æ–°ï¼ˆä¸æ”¹å˜æ¬¡ç‰ˆæœ¬å·ï¼‰
1.2.3: é”å®šç‰ˆæœ¬ï¼Œä¸è‡ªåŠ¨æ›´æ–°
latest: å§‹ç»ˆä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ï¼ˆä¸æ¨èï¼‰
```

#### å®‰å…¨æ¼æ´æ‰«æ

```bash
# 1. æ£€æŸ¥å·²çŸ¥æ¼æ´
npm audit

# 2. è‡ªåŠ¨ä¿®å¤
npm audit fix

# 3. å¼ºåˆ¶ä¿®å¤ï¼ˆå¯èƒ½ç ´åå…¼å®¹æ€§ï¼‰
npm audit fix --force

# 4. æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š
npm audit --json

# 5. ä½¿ç”¨ Snyk æ‰«æï¼ˆæ¨èï¼‰
npx snyk test
npx snyk monitor
```

**å®šæœŸæ›´æ–°ç­–ç•¥**ï¼š
```yaml
æ¯å‘¨:
  - æ£€æŸ¥å®‰å…¨æ¼æ´
  - ä¿®å¤é«˜å±æ¼æ´

æ¯æœˆ:
  - æ›´æ–°å°ç‰ˆæœ¬ï¼ˆMINORï¼‰
  - æµ‹è¯•å…¼å®¹æ€§
  - éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

æ¯å­£åº¦:
  - è¯„ä¼°å¤§ç‰ˆæœ¬å‡çº§ï¼ˆMAJORï¼‰
  - åˆ¶å®šå‡çº§è®¡åˆ’
  - åˆ†é˜¶æ®µå‡çº§
```

---

### 3.7 æ–‡æ¡£ç»´æŠ¤

#### API æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆï¼ˆSwaggerï¼‰

```typescript
// NestJS é…ç½® Swagger
import { DocumentBuilder, SwaggerModule } from '@nestjs/swagger';

const config = new DocumentBuilder()
  .setTitle('ä¸­å­¦ç”Ÿåœ¨çº¿æ•™è‚²å¹³å° API')
  .setDescription('API æ–‡æ¡£')
  .setVersion('1.0')
  .addBearerAuth()
  .build();

const document = SwaggerModule.createDocument(app, config);
SwaggerModule.setup('api-docs', app, document);

// è®¿é—® http://localhost:3000/api-docs æŸ¥çœ‹æ–‡æ¡£
```

#### ä»£ç æ³¨é‡Šè§„èŒƒï¼ˆJSDocï¼‰

```typescript
/**
 * ç”¨æˆ·æ³¨å†Œ
 * @param {RegisterDto} dto - æ³¨å†Œä¿¡æ¯
 * @returns {Promise<User>} ç”¨æˆ·å¯¹è±¡
 * @throws {ConflictException} é‚®ç®±å·²å­˜åœ¨
 */
@Post('register')
@ApiOperation({ summary: 'ç”¨æˆ·æ³¨å†Œ' })
@ApiResponse({ status: 201, description: 'æ³¨å†ŒæˆåŠŸ' })
@ApiResponse({ status: 409, description: 'é‚®ç®±å·²å­˜åœ¨' })
async register(@Body() dto: RegisterDto): Promise<User> {
  return this.authService.register(dto);
}
```

---

### 3.8 å˜æ›´æ—¥å¿—ï¼ˆCHANGELOG.mdï¼‰

```markdown
# Changelog

All notable changes to this project will be documented in this file.

## [1.2.0] - 2025-01-15

### Added
- æ–°å¢è®¨è®ºåŒºåŠŸèƒ½
- æ–°å¢å¸–å­å‘å¸ƒã€è¯„è®ºã€ç‚¹èµ
- æ–°å¢æ¶ˆæ¯é€šçŸ¥ç³»ç»Ÿ

### Changed
- ä¼˜åŒ–é¦–é¡µåŠ è½½é€Ÿåº¦
- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½

### Fixed
- ä¿®å¤ç™»å½• token è¿‡æœŸé—®é¢˜
- ä¿®å¤è§†é¢‘æ’­æ”¾è¿›åº¦ä¸åŒæ­¥

### Security
- ä¿®å¤ XSS æ¼æ´
- å‡çº§ä¾èµ–åŒ…ç‰ˆæœ¬

## [1.1.0] - 2025-01-01

### Added
- æ–°å¢æˆé•¿ç³»ç»Ÿ
- æ–°å¢æ’è¡Œæ¦œåŠŸèƒ½

## [1.0.0] - 2024-12-15

### Added
- ç”¨æˆ·æ³¨å†Œç™»å½•
- è¯¾ç¨‹å­¦ä¹ 
- é¢˜åº“ç»ƒä¹ 
- å­¦ä¹ ç»Ÿè®¡
```

---

## 4. æ•°æ®å¤‡ä»½ä¸ç»´æŠ¤æ–¹æ¡ˆ

### 4.1 æ•°æ®åº“å¤‡ä»½ç­–ç•¥

#### å¤‡ä»½ç±»å‹

**1. å…¨é‡å¤‡ä»½ï¼ˆFull Backupï¼‰**
```bash
# æ¯å‘¨æ—¥å‡Œæ™¨ 2 ç‚¹æ‰§è¡Œå…¨é‡å¤‡ä»½
0 2 * * 0 /usr/local/bin/backup_full.sh

# backup_full.sh
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backup/postgres/full"
DB_NAME="education_platform"

# å¯¼å‡ºæ•´ä¸ªæ•°æ®åº“
pg_dump -U postgres -h localhost $DB_NAME | gzip > $BACKUP_DIR/full_backup_$DATE.sql.gz

# ä¿ç•™æœ€è¿‘ 4 å‘¨çš„å¤‡ä»½
find $BACKUP_DIR -name "full_backup_*.sql.gz" -mtime +28 -delete

# ä¸Šä¼ åˆ°äº‘å­˜å‚¨ï¼ˆé˜¿é‡Œäº‘ OSSï¼‰
aliyun oss cp $BACKUP_DIR/full_backup_$DATE.sql.gz oss://backup-bucket/postgres/
```

**2. å¢é‡å¤‡ä»½ï¼ˆIncremental Backupï¼‰**
```bash
# æ¯å¤©å‡Œæ™¨ 3 ç‚¹æ‰§è¡Œå¢é‡å¤‡ä»½
0 3 * * * /usr/local/bin/backup_incremental.sh

# backup_incremental.sh
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backup/postgres/incremental"

# ä½¿ç”¨ WALï¼ˆWrite-Ahead Loggingï¼‰å½’æ¡£
# åªå¤‡ä»½è‡ªä¸Šæ¬¡å¤‡ä»½ä»¥æ¥çš„æ›´æ”¹
pg_basebackup -U postgres -D $BACKUP_DIR/incremental_$DATE -Fp -Xs -P

# ä¿ç•™æœ€è¿‘ 7 å¤©çš„å¢é‡å¤‡ä»½
find $BACKUP_DIR -name "incremental_*" -mtime +7 -delete
```

**3. å®æ—¶å¤‡ä»½ï¼ˆContinuous Archivingï¼‰**
```sql
-- PostgreSQL é…ç½®ï¼ˆpostgresql.confï¼‰
wal_level = replica
archive_mode = on
archive_command = 'cp %p /backup/postgres/wal_archive/%f'
max_wal_senders = 3
```

---

#### å¤‡ä»½è®¡åˆ’è¡¨

| å¤‡ä»½ç±»å‹ | é¢‘ç‡ | ä¿ç•™æ—¶é—´ | å­˜å‚¨ä½ç½® | æ¢å¤æ—¶é—´ |
|---------|------|---------|---------|---------|
| å…¨é‡å¤‡ä»½ | æ¯å‘¨æ—¥ | 4 å‘¨ | æœ¬åœ° + OSS | 1-2 å°æ—¶ |
| å¢é‡å¤‡ä»½ | æ¯å¤© | 7 å¤© | æœ¬åœ° | 30 åˆ†é’Ÿ |
| å®æ—¶å½’æ¡£ | å®æ—¶ | 7 å¤© | æœ¬åœ° | 10 åˆ†é’Ÿ |
| è¿œç¨‹å¤‡ä»½ | æ¯å‘¨ | æ°¸ä¹… | OSS | 2-4 å°æ—¶ |

---

### 4.2 æ•°æ®æ¢å¤æµç¨‹

#### åœºæ™¯ 1ï¼šè¯¯åˆ é™¤æ•°æ®ï¼ˆå½“å¤©å†…ï¼‰
```bash
# 1. åœæ­¢åº”ç”¨æœåŠ¡ï¼ˆé˜²æ­¢æ•°æ®ç»§ç»­å†™å…¥ï¼‰
pm2 stop all

# 2. æ¢å¤åˆ°æœ€è¿‘çš„å¢é‡å¤‡ä»½
pg_restore -U postgres -d education_platform /backup/postgres/incremental_20250108/

# 3. åº”ç”¨ WAL æ—¥å¿—ï¼ˆæ¢å¤åˆ°è¯¯åˆ é™¤å‰ï¼‰
pg_waldump /backup/postgres/wal_archive/

# 4. éªŒè¯æ•°æ®å®Œæ•´æ€§
psql -U postgres -d education_platform -c "SELECT COUNT(*) FROM users;"

# 5. é‡å¯åº”ç”¨
pm2 start all
```

#### åœºæ™¯ 2ï¼šæ•°æ®åº“å´©æºƒ
```bash
# 1. ä½¿ç”¨æœ€è¿‘çš„å…¨é‡å¤‡ä»½
gunzip /backup/postgres/full/full_backup_20250105.sql.gz

# 2. æ¢å¤æ•°æ®åº“
psql -U postgres -d education_platform < /backup/postgres/full/full_backup_20250105.sql

# 3. åº”ç”¨å¢é‡å¤‡ä»½ï¼ˆå¦‚æœæœ‰ï¼‰
pg_restore -U postgres -d education_platform /backup/postgres/incremental_20250107/

# 4. éªŒè¯æ•°æ®
# 5. é‡å¯åº”ç”¨
```

---

### 4.3 æ•°æ®æ¸…ç†ä¸å½’æ¡£

#### å®šæœŸæ¸…ç†ç­–ç•¥

```sql
-- 1. æ¸…ç†è¿‡æœŸæ—¥å¿—ï¼ˆ90 å¤©å‰ï¼‰
DELETE FROM admin_logs WHERE created_at < NOW() - INTERVAL '90 days';

-- 2. æ¸…ç†å·²è¯»é€šçŸ¥ï¼ˆ30 å¤©å‰ï¼‰
DELETE FROM notifications WHERE is_read = true AND created_at < NOW() - INTERVAL '30 days';

-- 3. æ¸…ç†å·²åˆ é™¤çš„å¸–å­ï¼ˆ30 å¤©å‰ï¼‰
DELETE FROM posts WHERE status = 'deleted' AND updated_at < NOW() - INTERVAL '30 days';

-- 4. å½’æ¡£å†å²ç­”é¢˜è®°å½•ï¼ˆ1 å¹´å‰ï¼‰
-- å°†æ—§æ•°æ®è¿ç§»åˆ°å½’æ¡£è¡¨
INSERT INTO user_answers_archive
SELECT * FROM user_answers WHERE created_at < NOW() - INTERVAL '1 year';

DELETE FROM user_answers WHERE created_at < NOW() - INTERVAL '1 year';
```

**å®šæ—¶ä»»åŠ¡ï¼ˆCronï¼‰**ï¼š
```bash
# æ¯æœˆ 1 å·å‡Œæ™¨ 4 ç‚¹æ‰§è¡Œæ•°æ®æ¸…ç†
0 4 1 * * /usr/local/bin/data_cleanup.sh
```

---

### 4.4 æ•°æ®åº“æ€§èƒ½ç›‘æ§

#### æ…¢æŸ¥è¯¢ç›‘æ§

```sql
-- å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆpostgresql.confï¼‰
log_min_duration_statement = 100  # è®°å½•æ‰§è¡Œæ—¶é—´ >100ms çš„æŸ¥è¯¢
log_statement = 'all'

-- æŸ¥çœ‹æ…¢æŸ¥è¯¢
SELECT query, calls, total_time, mean_time
FROM pg_stat_statements
ORDER BY total_time DESC
LIMIT 10;

-- åˆ†æå…·ä½“æŸ¥è¯¢
EXPLAIN ANALYZE
SELECT * FROM user_answers WHERE user_id = 123;
```

#### æ•°æ®åº“å¥åº·æ£€æŸ¥

```bash
# å®šæœŸæ£€æŸ¥è„šæœ¬ï¼ˆhealth_check.shï¼‰
#!/bin/bash

# 1. æ£€æŸ¥æ•°æ®åº“è¿æ¥
psql -U postgres -d education_platform -c "SELECT 1" > /dev/null 2>&1
if [ $? -ne 0 ]; then
  echo "Database connection failed!"
  # å‘é€å‘Šè­¦ï¼ˆé‚®ä»¶/çŸ­ä¿¡/é’‰é’‰ï¼‰
  exit 1
fi

# 2. æ£€æŸ¥ç£ç›˜ç©ºé—´
DISK_USAGE=$(df -h /var/lib/postgresql | awk 'NR==2 {print $5}' | sed 's/%//')
if [ $DISK_USAGE -gt 80 ]; then
  echo "Disk usage is over 80%: ${DISK_USAGE}%"
  # å‘é€å‘Šè­¦
fi

# 3. æ£€æŸ¥è¿æ¥æ•°
CONN_COUNT=$(psql -U postgres -t -c "SELECT count(*) FROM pg_stat_activity;")
if [ $CONN_COUNT -gt 200 ]; then
  echo "Too many connections: $CONN_COUNT"
  # å‘é€å‘Šè­¦
fi

# 4. æ£€æŸ¥æ…¢æŸ¥è¯¢æ•°é‡
SLOW_QUERY_COUNT=$(psql -U postgres -t -c "SELECT count(*) FROM pg_stat_statements WHERE mean_time > 100;")
if [ $SLOW_QUERY_COUNT -gt 50 ]; then
  echo "Too many slow queries: $SLOW_QUERY_COUNT"
  # å‘é€å‘Šè­¦
fi

echo "Health check passed!"
```

---

### 4.5 æ•°æ®åº“å‡çº§ç­–ç•¥

#### PostgreSQL ç‰ˆæœ¬å‡çº§

```yaml
å½“å‰ç‰ˆæœ¬: PostgreSQL 14
ç›®æ ‡ç‰ˆæœ¬: PostgreSQL 15

å‡çº§æ­¥éª¤:
  1. å‡†å¤‡é˜¶æ®µï¼ˆ1 å¤©ï¼‰:
     - é˜…è¯»å‡çº§æ–‡æ¡£
     - æ£€æŸ¥å…¼å®¹æ€§
     - å‡†å¤‡æµ‹è¯•ç¯å¢ƒ
     - å…¨é‡å¤‡ä»½æ•°æ®

  2. æµ‹è¯•ç¯å¢ƒå‡çº§ï¼ˆ1 å¤©ï¼‰:
     - å®‰è£… PostgreSQL 15
     - è¿ç§»æµ‹è¯•æ•°æ®
     - è¿è¡Œæµ‹è¯•ç”¨ä¾‹
     - æ€§èƒ½åŸºå‡†æµ‹è¯•

  3. ç”Ÿäº§ç¯å¢ƒå‡çº§ï¼ˆç»´æŠ¤çª—å£ï¼‰:
     - é€šçŸ¥ç”¨æˆ·ï¼ˆæå‰ 3 å¤©ï¼‰
     - åœæ­¢åº”ç”¨æœåŠ¡
     - æ‰§è¡Œå‡çº§
     - éªŒè¯æ•°æ®å®Œæ•´æ€§
     - é‡å¯åº”ç”¨

  4. å›æ»šè®¡åˆ’:
     - ä¿ç•™æ—§ç‰ˆæœ¬å¤‡ä»½
     - å‡†å¤‡å›æ»šè„šæœ¬
     - è®¾ç½®å›æ»šæ—¶é—´é™åˆ¶ï¼ˆ1 å°æ—¶å†…ï¼‰
```

---

### 4.6 ç¾éš¾æ¢å¤è®¡åˆ’ï¼ˆDRPï¼‰

#### RTO & RPO ç›®æ ‡

```yaml
RTO (Recovery Time Objective) - æ¢å¤æ—¶é—´ç›®æ ‡:
  - æ•°æ®åº“å´©æºƒ: 1 å°æ—¶å†…æ¢å¤
  - æœåŠ¡å™¨æ•…éšœ: 2 å°æ—¶å†…åˆ‡æ¢å¤‡ç”¨æœåŠ¡å™¨
  - æ•´ä¸ªç³»ç»Ÿç˜«ç—ª: 4 å°æ—¶å†…æ¢å¤æ ¸å¿ƒåŠŸèƒ½

RPO (Recovery Point Objective) - æ¢å¤ç‚¹ç›®æ ‡:
  - æ•°æ®ä¸¢å¤±: æœ€å¤šä¸¢å¤± 15 åˆ†é’Ÿæ•°æ®ï¼ˆå¢é‡å¤‡ä»½é—´éš”ï¼‰
  - å¯æ¥å—æ•°æ®ä¸¢å¤±: æ¯å¤©å¢é‡å¤‡ä»½ + WAL å½’æ¡£
```

#### ç¾éš¾æ¢å¤æ¼”ç»ƒ

```yaml
æ¼”ç»ƒé¢‘ç‡: æ¯å­£åº¦ä¸€æ¬¡

æ¼”ç»ƒå†…å®¹:
  1. æ•°æ®åº“æ¢å¤æµ‹è¯•ï¼ˆ30 åˆ†é’Ÿï¼‰
  2. åº”ç”¨æœåŠ¡å™¨åˆ‡æ¢ï¼ˆ30 åˆ†é’Ÿï¼‰
  3. å®Œæ•´ç³»ç»Ÿæ¢å¤ï¼ˆ2 å°æ—¶ï¼‰
  4. æ€»ç»“ä¸æ”¹è¿›

æ¼”ç»ƒæ­¥éª¤:
  1. æ¨¡æ‹Ÿæ•°æ®åº“æ•…éšœ
  2. ä»å¤‡ä»½æ¢å¤æ•°æ®
  3. å¯åŠ¨å¤‡ç”¨æœåŠ¡å™¨
  4. éªŒè¯ç³»ç»ŸåŠŸèƒ½
  5. è®°å½•æ¢å¤æ—¶é—´
  6. ä¼˜åŒ–æ¢å¤æµç¨‹
```

---

## 5. æ ¸å¿ƒ API æ¥å£æ¸…å•

### 5.1 è®¤è¯ä¸ç”¨æˆ·æ¨¡å—

#### è®¤è¯æ¥å£
```yaml
POST   /api/auth/register
æè¿°: ç”¨æˆ·æ³¨å†Œ
è¯·æ±‚ä½“:
  {
    "username": "xiaoming",
    "email": "xiaoming@example.com",
    "password": "Password123!",
    "phone": "13800138000"
  }
å“åº”:
  {
    "success": true,
    "data": {
      "user": { "id": 1, "username": "xiaoming" },
      "token": "eyJhbGc..."
    }
  }

---

POST   /api/auth/login
æè¿°: ç”¨æˆ·ç™»å½•
è¯·æ±‚ä½“:
  {
    "email": "xiaoming@example.com",
    "password": "Password123!"
  }
å“åº”:
  {
    "success": true,
    "data": {
      "accessToken": "eyJhbGc...",
      "refreshToken": "eyJhbGc...",
      "expiresIn": 3600
    }
  }

---

POST   /api/auth/logout
æè¿°: ç”¨æˆ·ç™»å‡º
è¯·æ±‚å¤´: Authorization: Bearer <token>
å“åº”:
  {
    "success": true,
    "message": "ç™»å‡ºæˆåŠŸ"
  }

---

POST   /api/auth/refresh
æè¿°: åˆ·æ–° token
è¯·æ±‚ä½“:
  {
    "refreshToken": "eyJhbGc..."
  }
å“åº”:
  {
    "success": true,
    "data": {
      "accessToken": "eyJhbGc...",
      "expiresIn": 3600
    }
  }

---

POST   /api/auth/send-code
æè¿°: å‘é€éªŒè¯ç 
è¯·æ±‚ä½“:
  {
    "phone": "13800138000",
    "type": "register" | "login" | "reset_password"
  }
å“åº”:
  {
    "success": true,
    "message": "éªŒè¯ç å·²å‘é€"
  }
é™æµ: 1 æ¬¡/åˆ†é’Ÿ/æ‰‹æœºå·, 10 æ¬¡/å°æ—¶/æ‰‹æœºå·

---

POST   /api/auth/reset-password
æè¿°: é‡ç½®å¯†ç 
è¯·æ±‚ä½“:
  {
    "phone": "13800138000",
    "code": "123456",
    "newPassword": "NewPassword123!"
  }
```

#### ç”¨æˆ·ä¿¡æ¯æ¥å£
```yaml
GET    /api/users/me
æè¿°: è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
è¯·æ±‚å¤´: Authorization: Bearer <token>
å“åº”:
  {
    "success": true,
    "data": {
      "id": 1,
      "username": "xiaoming",
      "email": "xiaoming@example.com",
      "profile": {
        "realName": "å°æ˜",
        "grade": 9,
        "className": "3ç­"
      }
    }
  }

---

PUT    /api/users/me
æè¿°: æ›´æ–°ç”¨æˆ·ä¿¡æ¯
è¯·æ±‚ä½“:
  {
    "realName": "å°æ˜",
    "grade": 9,
    "className": "3ç­",
    "school": "æŸæŸä¸­å­¦"
  }

---

POST   /api/users/avatar
æè¿°: ä¸Šä¼ å¤´åƒ
è¯·æ±‚: multipart/form-data
  file: <image file>
å“åº”:
  {
    "success": true,
    "data": {
      "avatarUrl": "https://cdn.example.com/avatars/user123.jpg"
    }
  }
é™åˆ¶: æœ€å¤§ 2MB, æ”¯æŒ jpg/png

---

PUT    /api/users/password
æè¿°: ä¿®æ”¹å¯†ç 
è¯·æ±‚ä½“:
  {
    "currentPassword": "OldPassword123!",
    "newPassword": "NewPassword123!"
  }
```

---

### 5.2 è¯¾ç¨‹å­¦ä¹ æ¨¡å—

```yaml
GET    /api/subjects
æè¿°: è·å–æ‰€æœ‰å­¦ç§‘åˆ—è¡¨
æŸ¥è¯¢å‚æ•°: æ— 
å“åº”:
  {
    "success": true,
    "data": [
      {
        "id": 1,
        "name": "æ•°å­¦",
        "icon": "ğŸ“",
        "color": "bg-blue-500",
        "totalChapters": 12,
        "completedChapters": 3
      },
      ...
    ]
  }

---

GET    /api/subjects/:id
æè¿°: è·å–å­¦ç§‘è¯¦æƒ…
è·¯å¾„å‚æ•°: id (å­¦ç§‘ID)
å“åº”:
  {
    "success": true,
    "data": {
      "id": 1,
      "name": "æ•°å­¦",
      "description": "åˆä¸­æ•°å­¦è¯¾ç¨‹",
      "totalChapters": 12,
      "totalLessons": 120,
      "userProgress": {
        "completedLessons": 30,
        "progress": 25
      }
    }
  }

---

GET    /api/subjects/:id/chapters
æè¿°: è·å–å­¦ç§‘ç« èŠ‚åˆ—è¡¨
è·¯å¾„å‚æ•°: id (å­¦ç§‘ID)
å“åº”:
  {
    "success": true,
    "data": [
      {
        "id": 1,
        "title": "ç¬¬ä¸€ç« ï¼šæœ‰ç†æ•°",
        "lessonCount": 10,
        "completedCount": 3,
        "progress": 30
      },
      ...
    ]
  }

---

GET    /api/chapters/:id
æè¿°: è·å–ç« èŠ‚è¯¦æƒ…
å“åº”:
  {
    "success": true,
    "data": {
      "id": 1,
      "title": "ç¬¬ä¸€ç« ï¼šæœ‰ç†æ•°",
      "description": "æœ¬ç« å­¦ä¹ æœ‰ç†æ•°çš„æ¦‚å¿µå’Œè¿ç®—",
      "lessons": [
        {
          "id": 1,
          "title": "1.1 æ­£æ•°å’Œè´Ÿæ•°",
          "type": "video",
          "duration": 1200,
          "completed": true,
          "locked": false
        },
        ...
      ]
    }
  }

---

GET    /api/lessons/:id
æè¿°: è·å–è¯¾æ—¶è¯¦æƒ…
å“åº”:
  {
    "success": true,
    "data": {
      "id": 1,
      "title": "1.1 æ­£æ•°å’Œè´Ÿæ•°",
      "type": "video",
      "duration": 1200,
      "description": "å­¦ä¹ æ­£æ•°å’Œè´Ÿæ•°çš„æ¦‚å¿µ",
      "materials": [
        {
          "type": "pdf",
          "title": "è¯¾ä»¶",
          "url": "https://..."
        }
      ],
      "userProgress": {
        "lastPosition": 600,
        "completed": false
      }
    }
  }

---

GET    /api/lessons/:id/video-url
æè¿°: è·å–è§†é¢‘æ’­æ”¾åœ°å€ï¼ˆé˜²ç›—é“¾ç­¾åï¼‰
å“åº”:
  {
    "success": true,
    "data": {
      "url": "https://cdn.example.com/videos/lesson1.m3u8?signature=...",
      "expiresAt": "2025-01-08T10:00:00Z"
    }
  }
è¯´æ˜: URL æœ‰æ•ˆæœŸ 1 å°æ—¶ï¼Œéœ€è¦ç™»å½•éªŒè¯

---

POST   /api/learning/progress
æè¿°: æ›´æ–°å­¦ä¹ è¿›åº¦
è¯·æ±‚ä½“:
  {
    "lessonId": 1,
    "position": 600,
    "duration": 1200,
    "completed": false
  }
å“åº”:
  {
    "success": true,
    "message": "è¿›åº¦å·²æ›´æ–°"
  }
é¢‘ç‡: æ¯ 30 ç§’ä¸ŠæŠ¥ä¸€æ¬¡

---

GET    /api/learning/progress
æè¿°: è·å–å­¦ä¹ è¿›åº¦
æŸ¥è¯¢å‚æ•°:
  - subjectId (å¯é€‰): å­¦ç§‘ID
  - chapterId (å¯é€‰): ç« èŠ‚ID
å“åº”:
  {
    "success": true,
    "data": [
      {
        "lessonId": 1,
        "progress": 50,
        "lastPosition": 600,
        "completed": false,
        "updatedAt": "2025-01-08T09:30:00Z"
      },
      ...
    ]
  }

---

GET    /api/learning/recent
æè¿°: è·å–æœ€è¿‘å­¦ä¹ è®°å½•
æŸ¥è¯¢å‚æ•°:
  - limit (å¯é€‰): è¿”å›æ•°é‡ï¼Œé»˜è®¤ 10
å“åº”:
  {
    "success": true,
    "data": [
      {
        "lesson": {
          "id": 1,
          "title": "1.1 æ­£æ•°å’Œè´Ÿæ•°",
          "subject": "æ•°å­¦"
        },
        "progress": 50,
        "lastStudyAt": "2025-01-08T09:30:00Z"
      },
      ...
    ]
  }
```

---

### 5.3 é¢˜åº“ç»ƒä¹ æ¨¡å—

```yaml
GET    /api/questions
æè¿°: è·å–é¢˜ç›®åˆ—è¡¨
æŸ¥è¯¢å‚æ•°:
  - subjectId (å¯é€‰): å­¦ç§‘ID
  - chapterId (å¯é€‰): ç« èŠ‚ID
  - difficulty (å¯é€‰): easy | medium | hard
  - type (å¯é€‰): single_choice | multiple_choice | true_false
  - page: é¡µç ï¼Œé»˜è®¤ 1
  - pageSize: æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ 20
å“åº”:
  {
    "success": true,
    "data": {
      "items": [
        {
          "id": 1,
          "content": "1 + 1 = ?",
          "type": "single_choice",
          "difficulty": "easy",
          "points": 1
        },
        ...
      ],
      "pagination": {
        "page": 1,
        "pageSize": 20,
        "total": 500,
        "totalPages": 25
      }
    }
  }

---

GET    /api/questions/:id
æè¿°: è·å–é¢˜ç›®è¯¦æƒ…
å“åº”:
  {
    "success": true,
    "data": {
      "id": 1,
      "content": "1 + 1 = ?",
      "type": "single_choice",
      "difficulty": "easy",
      "points": 1,
      "options": [
        { "key": "A", "content": "1" },
        { "key": "B", "content": "2" },
        { "key": "C", "content": "3" },
        { "key": "D", "content": "4" }
      ]
    }
  }
è¯´æ˜: ä¸è¿”å›ç­”æ¡ˆï¼Œé˜²æ­¢ä½œå¼Š

---

GET    /api/question-sets
æè¿°: è·å–ç»ƒä¹ é›†åˆ—è¡¨
æŸ¥è¯¢å‚æ•°:
  - subjectId (å¯é€‰): å­¦ç§‘ID
  - difficulty (å¯é€‰): easy | medium | hard
å“åº”:
  {
    "success": true,
    "data": [
      {
        "id": 1,
        "title": "äºŒæ¬¡å‡½æ•°ä¸“é¡¹ç»ƒä¹ ",
        "subject": "æ•°å­¦",
        "difficulty": "medium",
        "questionCount": 20,
        "timeLimit": 30,
        "completed": false
      },
      ...
    ]
  }

---

GET    /api/question-sets/:id
æè¿°: è·å–ç»ƒä¹ é›†è¯¦æƒ…
å“åº”:
  {
    "success": true,
    "data": {
      "id": 1,
      "title": "äºŒæ¬¡å‡½æ•°ä¸“é¡¹ç»ƒä¹ ",
      "description": "å·©å›ºäºŒæ¬¡å‡½æ•°çŸ¥è¯†ç‚¹",
      "difficulty": "medium",
      "questionCount": 20,
      "timeLimit": 30,
      "totalPoints": 100,
      "questions": [
        {
          "id": 1,
          "content": "...",
          "type": "single_choice",
          "points": 5
        },
        ...
      ]
    }
  }

---

POST   /api/answers
æè¿°: æäº¤ç­”æ¡ˆï¼ˆå•é¢˜æˆ–æ•´å¥—ï¼‰
è¯·æ±‚ä½“:
  {
    "questionId": 1,
    "questionSetId": 1,
    "userAnswer": "B",
    "timeSpent": 30
  }
  æˆ–
  {
    "questionSetId": 1,
    "answers": [
      { "questionId": 1, "userAnswer": "B", "timeSpent": 30 },
      { "questionId": 2, "userAnswer": "A", "timeSpent": 45 },
      ...
    ]
  }
å“åº”:
  {
    "success": true,
    "data": {
      "isCorrect": true,
      "correctAnswer": "B",
      "explanation": "1 + 1 = 2ï¼Œè¿™æ˜¯åŸºç¡€è¿ç®—",
      "score": 5
    }
  }
  æˆ–ï¼ˆæäº¤æ•´å¥—ï¼‰
  {
    "success": true,
    "data": {
      "reportId": 123,
      "totalScore": 85,
      "correctCount": 17,
      "totalCount": 20,
      "accuracy": 85
    }
  }

---

GET    /api/answers/stats
æè¿°: è·å–ç­”é¢˜ç»Ÿè®¡
æŸ¥è¯¢å‚æ•°:
  - subjectId (å¯é€‰): å­¦ç§‘ID
  - period (å¯é€‰): week | month | all_time
å“åº”:
  {
    "success": true,
    "data": {
      "totalQuestions": 500,
      "correctQuestions": 425,
      "accuracy": 85,
      "avgTimePerQuestion": 45,
      "subjectStats": [
        {
          "subject": "æ•°å­¦",
          "totalQuestions": 200,
          "correctQuestions": 170,
          "accuracy": 85
        },
        ...
      ]
    }
  }

---

GET    /api/answers/report/:id
æè¿°: è·å–ç­”é¢˜æŠ¥å‘Š
å“åº”:
  {
    "success": true,
    "data": {
      "id": 123,
      "questionSet": {
        "title": "äºŒæ¬¡å‡½æ•°ä¸“é¡¹ç»ƒä¹ "
      },
      "totalScore": 85,
      "correctCount": 17,
      "totalCount": 20,
      "accuracy": 85,
      "timeSpent": 1200,
      "details": [
        {
          "question": {
            "id": 1,
            "content": "..."
          },
          "userAnswer": "B",
          "correctAnswer": "B",
          "isCorrect": true,
          "score": 5
        },
        ...
      ],
      "createdAt": "2025-01-08T10:00:00Z"
    }
  }

---

GET    /api/wrong-questions
æè¿°: è·å–é”™é¢˜æœ¬
æŸ¥è¯¢å‚æ•°:
  - subjectId (å¯é€‰): å­¦ç§‘ID
  - mastered (å¯é€‰): true | falseï¼ˆæ˜¯å¦å·²æŒæ¡ï¼‰
å“åº”:
  {
    "success": true,
    "data": [
      {
        "question": {
          "id": 1,
          "content": "...",
          "difficulty": "medium"
        },
        "wrongCount": 3,
        "mastered": false,
        "lastWrongAt": "2025-01-08T10:00:00Z"
      },
      ...
    ]
  }

---

POST   /api/wrong-questions/:id/master
æè¿°: æ ‡è®°é”™é¢˜å·²æŒæ¡
å“åº”:
  {
    "success": true,
    "message": "å·²æ ‡è®°ä¸ºæŒæ¡"
  }
```

---

### 5.4 ç»Ÿè®¡åˆ†ææ¨¡å—

```yaml
GET    /api/stats/overview
æè¿°: è·å–é¦–é¡µæ¦‚è§ˆç»Ÿè®¡
å“åº”:
  {
    "success": true,
    "data": {
      "todayStudyTime": 150, // åˆ†é’Ÿ
      "weekQuestionsCount": 156,
      "totalBadges": 18,
      "progressRank": 15, // ç™¾åˆ†æ¯”
      "streakDays": 13
    }
  }

---

GET    /api/stats/today-tasks
æè¿°: è·å–ä»Šæ—¥å­¦ä¹ ä»»åŠ¡
å“åº”:
  {
    "success": true,
    "data": [
      {
        "subject": "æ•°å­¦",
        "task": "å®ŒæˆäºŒæ¬¡å‡½æ•°ç»ƒä¹ ",
        "progress": 60,
        "total": 20,
        "completed": 12
      },
      ...
    ]
  }

---

GET    /api/stats/performance
æè¿°: è·å–å­¦ä¹ æˆç»©ç»Ÿè®¡
å“åº”:
  {
    "success": true,
    "data": {
      "percentileRank": 65,
      "avgPracticeScore": 82,
      "avgExamScore": 64
    }
  }

---

GET    /api/stats/weekly-chart
æè¿°: è·å–æ¯å‘¨å­¦ä¹ æ—¶é•¿å›¾è¡¨æ•°æ®
å“åº”:
  {
    "success": true,
    "data": [
      { "day": "å‘¨ä¸€", "time": 45 },
      { "day": "å‘¨äºŒ", "time": 60 },
      ...
    ]
  }

---

GET    /api/stats/score-trend
æè¿°: è·å–æˆç»©è¶‹åŠ¿å›¾è¡¨æ•°æ®
å“åº”:
  {
    "success": true,
    "data": [
      { "month": "9æœˆ", "score": 65 },
      { "month": "10æœˆ", "score": 72 },
      ...
    ]
  }

---

GET    /api/stats/subject/:id/chapters
æè¿°: è·å–å­¦ç§‘å„ç« èŠ‚æŒæ¡åº¦
å“åº”:
  {
    "success": true,
    "data": [
      {
        "chapter": "ç¬¬ä¸€ç« ï¼šæœ‰ç†æ•°",
        "progress": 85,
        "level": "ç†Ÿç»ƒ"
      },
      ...
    ]
  }
```

---

### 5.5 è®¨è®ºç¤¾åŒºæ¨¡å—

```yaml
GET    /api/posts
æè¿°: è·å–å¸–å­åˆ—è¡¨
æŸ¥è¯¢å‚æ•°:
  - subjectId (å¯é€‰): å­¦ç§‘ID
  - sort (å¯é€‰): hot | newï¼ˆæ’åºæ–¹å¼ï¼‰
  - keyword (å¯é€‰): æœç´¢å…³é”®è¯
  - page: é¡µç 
  - pageSize: æ¯é¡µæ•°é‡
å“åº”:
  {
    "success": true,
    "data": {
      "items": [
        {
          "id": 1,
          "title": "äºŒæ¬¡å‡½æ•°çš„è§£é¢˜æŠ€å·§æœ‰å“ªäº›ï¼Ÿ",
          "content": "æœ€è¿‘åœ¨åšäºŒæ¬¡å‡½æ•°...",
          "author": {
            "id": 1,
            "username": "xiaoming",
            "avatar": "..."
          },
          "subject": "æ•°å­¦",
          "replyCount": 15,
          "viewCount": 234,
          "likeCount": 28,
          "isHot": true,
          "createdAt": "2025-01-08T10:00:00Z"
        },
        ...
      ],
      "pagination": { ... }
    }
  }

---

POST   /api/posts
æè¿°: å‘å¸ƒå¸–å­
è¯·æ±‚ä½“:
  {
    "subjectId": 1,
    "title": "äºŒæ¬¡å‡½æ•°çš„è§£é¢˜æŠ€å·§æœ‰å“ªäº›ï¼Ÿ",
    "content": "æœ€è¿‘åœ¨åšäºŒæ¬¡å‡½æ•°çš„é¢˜ç›®..."
  }
å“åº”:
  {
    "success": true,
    "data": {
      "id": 1,
      "title": "...",
      "createdAt": "2025-01-08T10:00:00Z"
    }
  }
é™æµ: 10 æ¬¡/å°æ—¶

---

GET    /api/posts/:id
æè¿°: è·å–å¸–å­è¯¦æƒ…
å“åº”:
  {
    "success": true,
    "data": {
      "id": 1,
      "title": "...",
      "content": "...",
      "author": { ... },
      "subject": "æ•°å­¦",
      "viewCount": 235, // è‡ªåŠ¨ +1
      "likeCount": 28,
      "replyCount": 15,
      "isLiked": false,
      "isFavorited": false,
      "createdAt": "2025-01-08T10:00:00Z"
    }
  }

---

PUT    /api/posts/:id
æè¿°: ç¼–è¾‘å¸–å­
è¯·æ±‚ä½“:
  {
    "title": "...",
    "content": "..."
  }
æƒé™: ä»…ä½œè€…å¯ç¼–è¾‘

---

DELETE /api/posts/:id
æè¿°: åˆ é™¤å¸–å­
æƒé™: ä»…ä½œè€…å’Œç®¡ç†å‘˜å¯åˆ é™¤

---

GET    /api/posts/:id/comments
æè¿°: è·å–å¸–å­è¯„è®º
æŸ¥è¯¢å‚æ•°:
  - page: é¡µç 
  - pageSize: æ¯é¡µæ•°é‡
å“åº”:
  {
    "success": true,
    "data": {
      "items": [
        {
          "id": 1,
          "content": "è¿™ä¸ªæ–¹æ³•å¾ˆå®ç”¨ï¼",
          "author": { ... },
          "likeCount": 5,
          "replies": [
            {
              "id": 2,
              "content": "åŒæ„ï¼",
              "author": { ... }
            }
          ],
          "createdAt": "2025-01-08T10:05:00Z"
        },
        ...
      ],
      "pagination": { ... }
    }
  }

---

POST   /api/posts/:id/comments
æè¿°: å‘è¡¨è¯„è®º
è¯·æ±‚ä½“:
  {
    "content": "è¿™ä¸ªæ–¹æ³•å¾ˆå®ç”¨ï¼",
    "parentId": null // å›å¤è¯„è®ºæ—¶æä¾›çˆ¶è¯„è®ºID
  }
é™æµ: 30 æ¬¡/å°æ—¶

---

POST   /api/posts/:id/like
æè¿°: ç‚¹èµå¸–å­
å“åº”:
  {
    "success": true,
    "message": "ç‚¹èµæˆåŠŸ"
  }

---

DELETE /api/posts/:id/like
æè¿°: å–æ¶ˆç‚¹èµ
å“åº”:
  {
    "success": true,
    "message": "å·²å–æ¶ˆç‚¹èµ"
  }

---

POST   /api/posts/:id/favorite
æè¿°: æ”¶è—å¸–å­
å“åº”:
  {
    "success": true,
    "message": "æ”¶è—æˆåŠŸ"
  }

---

GET    /api/search/posts
æè¿°: æœç´¢å¸–å­
æŸ¥è¯¢å‚æ•°:
  - keyword: æœç´¢å…³é”®è¯
  - subjectId (å¯é€‰): å­¦ç§‘ID
  - page: é¡µç 
å“åº”:
  {
    "success": true,
    "data": {
      "items": [ ... ],
      "pagination": { ... }
    }
  }
```

---

### 5.6 æˆé•¿ç³»ç»Ÿæ¨¡å—

```yaml
GET    /api/growth/level
æè¿°: è·å–ç”¨æˆ·ç­‰çº§ä¿¡æ¯
å“åº”:
  {
    "success": true,
    "data": {
      "level": 12,
      "experience": 6500,
      "nextLevelExp": 10000,
      "progress": 65
    }
  }

---

GET    /api/growth/achievements
æè¿°: è·å–æˆå°±åˆ—è¡¨
å“åº”:
  {
    "success": true,
    "data": [
      {
        "id": 1,
        "name": "åˆå­¦è€…",
        "description": "å®Œæˆ 10 ä¸ªè¯¾æ—¶",
        "icon": "ğŸ¯",
        "unlocked": true,
        "unlockedAt": "2024-12-15T10:00:00Z"
      },
      {
        "id": 2,
        "name": "å‹¤å¥‹å¥½å­¦",
        "description": "è¿ç»­å­¦ä¹  7 å¤©",
        "icon": "â­",
        "unlocked": false,
        "progress": 5,
        "target": 7
      },
      ...
    ]
  }

---

POST   /api/growth/checkin
æè¿°: å­¦ä¹ æ‰“å¡
å“åº”:
  {
    "success": true,
    "data": {
      "streakDays": 14,
      "rewardExp": 50
    }
  }

---

GET    /api/growth/streak
æè¿°: è·å–è¿ç»­å­¦ä¹ å¤©æ•°
å“åº”:
  {
    "success": true,
    "data": {
      "streakDays": 13,
      "lastCheckinDate": "2025-01-08"
    }
  }

---

GET    /api/rankings
æè¿°: è·å–æ’è¡Œæ¦œ
æŸ¥è¯¢å‚æ•°:
  - type: class | grade | schoolï¼ˆæ’åç±»å‹ï¼‰
  - subjectId (å¯é€‰): å­¦ç§‘ID
  - period: week | month | all_time
  - limit: è¿”å›æ•°é‡ï¼Œé»˜è®¤ 100
å“åº”:
  {
    "success": true,
    "data": [
      {
        "rank": 1,
        "user": {
          "id": 1,
          "username": "xiaoming",
          "avatar": "..."
        },
        "score": 8520,
        "isMe": false
      },
      {
        "rank": 4,
        "user": {
          "id": 123,
          "username": "me",
          "avatar": "..."
        },
        "score": 7890,
        "isMe": true
      },
      ...
    ]
  }
```

---

### 5.7 é€šçŸ¥ç³»ç»Ÿæ¨¡å—

```yaml
GET    /api/notifications
æè¿°: è·å–é€šçŸ¥åˆ—è¡¨
æŸ¥è¯¢å‚æ•°:
  - type (å¯é€‰): comment | like | achievement | system
  - isRead (å¯é€‰): true | false
  - page: é¡µç 
å“åº”:
  {
    "success": true,
    "data": {
      "items": [
        {
          "id": 1,
          "type": "comment",
          "title": "æ–°è¯„è®º",
          "content": "xiaoming è¯„è®ºäº†ä½ çš„å¸–å­",
          "link": "/posts/123",
          "isRead": false,
          "createdAt": "2025-01-08T10:00:00Z"
        },
        ...
      ],
      "pagination": { ... },
      "unreadCount": 5
    }
  }

---

PUT    /api/notifications/:id/read
æè¿°: æ ‡è®°é€šçŸ¥å·²è¯»
å“åº”:
  {
    "success": true,
    "message": "å·²æ ‡è®°ä¸ºå·²è¯»"
  }

---

PUT    /api/notifications/read-all
æè¿°: æ ‡è®°å…¨éƒ¨é€šçŸ¥å·²è¯»
å“åº”:
  {
    "success": true,
    "message": "å·²å…¨éƒ¨æ ‡è®°ä¸ºå·²è¯»"
  }
```

---

## æ€»ç»“

æœ¬æ–‡æ¡£è¡¥å……äº†ä»¥ä¸‹å…³é”®å†…å®¹ï¼š

âœ… **Claude è¾…åŠ©å¼€å‘æ•ˆç‡åˆ†æ**ï¼šå¯æé€Ÿ 2-2.5 å€ï¼ŒèŠ‚çœ 50% å¼€å‘æ—¶é—´
âœ… **æ ¸å¿ƒæ•°æ®è¡¨æ¸…å•**ï¼šMVP éœ€è¦ 18 å¼ è¡¨ï¼ŒV1.0 éœ€è¦ 30 å¼ è¡¨
âœ… **ä»£ç ç»´æŠ¤ä¸å‡çº§ç®¡ç†**ï¼šGit Flowã€ç‰ˆæœ¬ç®¡ç†ã€CI/CDã€æ•°æ®åº“è¿ç§»
âœ… **æ•°æ®å¤‡ä»½ä¸ç»´æŠ¤æ–¹æ¡ˆ**ï¼šå…¨é‡å¤‡ä»½ã€å¢é‡å¤‡ä»½ã€ç¾éš¾æ¢å¤è®¡åˆ’
âœ… **æ ¸å¿ƒ API æ¥å£æ¸…å•**ï¼š50+ ä¸ªæ ¸å¿ƒæ¥å£ï¼ŒåŒ…å«è¯·æ±‚/å“åº”æ ¼å¼

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.1
**æœ€åæ›´æ–°**ï¼š2025-01-08
**ä½œè€…**ï¼šäº§å“å›¢é˜Ÿ
