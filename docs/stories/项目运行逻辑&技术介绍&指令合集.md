# 项目运行逻辑 & 技术介绍 & 指令合集

本文档旨在用通俗易懂的语言解释本项目的运行机制、核心技术概念以及日常开发所需的指令。

---

## 1. 项目运行逻辑：它是如何工作的？

你可以把这个应用想象成一家**"现代化智能餐厅"**。

1.  **前端 (Next.js App Router) - "餐厅前厅与服务员"**
    *   **页面渲染**：当用户访问网站时，Next.js (服务员) 会在服务器端先把页面 (菜单和环境) 准备好，然后一次性展示给用户。这比传统的"先给空盘子再上菜" (CSR) 速度更快，SEO 更好。
    *   **交互**：用户点击按钮（如"开始测验"），浏览器会发送请求。

2.  **Server Actions - "厨房直通窗口"**
    *   在本项目中，我们不使用传统的 REST API (繁琐的传话流程)。我们使用 **Server Actions**。
    *   **逻辑**：当用户在前端填写表单或点击按钮时，就像直接把小票递进了厨房窗口。前端函数直接调用后端逻辑，无需中间繁琐的 HTTP 接口定义。
    *   **安全**：虽然写起来像直接调用函数，但 Next.js 会自动加密并安全地处理网络传输。

3.  **Prisma ORM - "厨房翻译官"**
    *   厨房里的厨师 (数据库) 只听得懂 SQL 语言 (一种复杂的数据库方言)。
    *   **Prisma** 就是翻译官。我们的代码写的是 TypeScript (如 `db.user.findMany()`)，Prisma 会把它精准翻译成 SQL (`SELECT * FROM users`) 告诉数据库，并把结果翻译回 TypeScript 对象给代码使用。

4.  **Supabase - "全能后勤中心"**
    *   **数据库 (PostgreSQL)**：存放所有食材 (用户数据、课程内容、错题记录)。
    *   **身份认证 (Auth)**：门口的保安，负责发门禁卡 (登录/注册)，确保只有通过验证的人才能进入。
    *   **存储 (Storage)**：大仓库，存放视频文件和用户头像图片。

**简而言之的数据流向**：
用户点击 -> Next.js 页面 -> Server Action (后端逻辑) -> Prisma (翻译) -> Supabase (存取数据) -> 结果返回给用户。

---

## 2. 核心技术名词解释

### 基础架构
*   **Next.js (v14+)**: 一个基于 React 的**全栈框架**。它不仅负责画页面 (UI)，还能处理后端逻辑。它是整个项目的骨架。
*   **TypeScript**: **带“拼写检查”的 JavaScript**。它强制要求我们在写代码时定义好数据的形状 (比如：用户必须有名字和邮箱)。这样可以防止很多低级错误，像“安全网”一样保护代码。
*   **Tailwind CSS**: **积木式样式库**。我们不再写一大堆 CSS 文件，而是直接在 HTML 标签上写 `class="text-red-500 font-bold"`，像搭积木一样快速构建漂亮的界面。

### 数据与后端
*   **Supabase**: 一个**开源的后端即服务 (BaaS)**。它提供了数据库、登录系统和文件存储，让我们不需要自己搭建服务器去维护这些复杂的底层设施。
*   **PostgreSQL**: 世界最先进的**开源关系型数据库**。Supabase 的核心就是它。它是我们存储数据的"硬盘"。
*   **Prisma**: **数据库工具 (ORM)**。它让我们用写代码的方式操作数据库，并且能根据数据库结构自动生成类型定义，开发体验极佳。

### 部署与运维
*   **Vercel**: **不仅是托管平台，更是 Next.js 的亲妈**。我们将代码推送到 GitHub 后，Vercel 会自动获取代码，打包，并发布到全球的服务器上。它让上线变得像发朋友圈一样简单。

---

## 3. 常用指令合集

在项目根目录下，打开终端 (Terminal) 运行以下指令。

### 🚀 开发运行 (日常使用)

| 指令 | 作用 | 说明 |
| :--- | :--- | :--- |
| `npm run dev` | **启动开发服务器** | 最常用的指令。启动后访问 `http://localhost:3000` 进行开发。 |
| `npm run lint` | **代码检查** | 检查代码是否有语法错误或不符合规范的地方 (ESLint)。 |
| `npm run build` | **生产构建** | 模拟上线前的打包过程，检查是否有编译错误。 |

### 🗄️ 数据库管理 (Prisma & Supabase)

| 指令 | 作用 | 说明 |
| :--- | :--- | :--- |
| `npx prisma studio` | **打开数据库管理界面** | 强烈推荐！会在浏览器打开一个可视化的表格界面，可以直接查看和编辑数据库里的数据。 |
| `npx prisma generate` | **更新 Prisma 客户端** | 当你修改了 `schema.prisma` 后，必须运行此命令，让代码知道数据库结构变了。 |
| `npx prisma db push` | **同步结构到数据库** | 快速将 `schema.prisma` 的修改应用到 Supabase 数据库 (开发阶段用)。 |
| `npm run seed` | **填充种子数据** | 向数据库写入测试数据 (如初始课程、测试用户)。 |

### 🧪 测试 (Testing)

| 指令 | 作用 | 说明 |
| :--- | :--- | :--- |
| `npm run test` | **运行所有测试** | 运行项目中所有的单元测试和集成测试。 |
| `npm run test:watch` | **监听模式运行测试** | 修改代码后自动重新运行相关测试，TDD 开发必备。 |
| `npm run test:ui` | **可视化测试界面** | 启动 Vitest 的网页版界面，可以图形化地查看测试结果。 |

### 📦 依赖管理

| 指令 | 作用 | 说明 |
| :--- | :--- | :--- |
| `npm install <包名>` | **安装新依赖** | 例如 `npm install dayjs`。 |
| `npm install` | **安装所有依赖** | 拉取新代码后，如果 `package.json` 变了，需要运行这个。 |

---

**给开发者的建议**：
1.  每天开始工作前，先 `git pull` 拉取最新代码，然后 `npm install` 确保依赖最新。
2.  遇到数据库报错，先试试 `npx prisma generate`。
3.  想看数据到底存进去没？直接运行 `npx prisma studio`。
